<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="Intervals Module" href="intervals.html" /><link rel="prev" title="API Reference" href="api-reference.html" />

    <link rel="shortcut icon" href="../_static/favicon.svg"/><!-- Generated with Sphinx 8.1.3 and Furo 2024.08.06 -->
        <title>TSDF Module - Tempo 0.1.29 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-dropdown.css?v=995e94df" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-bootstrap.min.css?v=21c0b90a" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=302659d7" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">Tempo 0.1.29 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="../_static/tempo - light background.svg" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="../_static/tempo - dark background.svg" alt="Dark Logo"/>
  </div>
  
  <span class="sidebar-brand-text">Tempo 0.1.29 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1"><a class="reference external" href="https://databricks.com/learn/labs">Databricks Labs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../about/user-guide.html">User Guide</a></li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="api-reference.html">API Reference</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of API Reference</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">TSDF Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="intervals.html">Intervals Module</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../about/contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../about/tempo-team.html">Tempo Team</a></li>
<li class="toctree-l1"><a class="reference internal" href="../about/future-roadmap.html">Future Roadmap</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../_sources/references/tsdf.rst.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="module-tempo.tsdf">
<span id="tsdf-module"></span><h1>TSDF Module<a class="headerlink" href="#module-tempo.tsdf" title="Link to this heading">¶</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="tempo.tsdf.Comparable">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tempo.tsdf.</span></span><span class="sig-name descname"><span class="pre">Comparable</span></span><a class="reference internal" href="../_modules/tempo/tsdf.html#Comparable"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tempo.tsdf.Comparable" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>For typing functions generated by operator_dict</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="tempo.tsdf.TSDF">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tempo.tsdf.</span></span><span class="sig-name descname"><span class="pre">TSDF</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ts_col</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'event_ts'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">partition_cols</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sequence_col</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tempo/tsdf.html#TSDF"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tempo.tsdf.TSDF" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>This object is the main wrapper over a Spark data frame which allows a user to parallelize time series computations on a Spark data frame by various dimensions. The two dimensions required are partition_cols (list of columns by which to summarize) and ts_col (timestamp column, which can be epoch or TimestampType).</p>
<dl class="py method">
<dt class="sig sig-object py" id="tempo.tsdf.TSDF.EMA">
<span class="sig-name descname"><span class="pre">EMA</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">colName</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exp_factor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.2</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#tempo.tsdf.TSDF" title="tempo.tsdf.TSDF"><span class="pre">TSDF</span></a></span></span><a class="reference internal" href="../_modules/tempo/tsdf.html#TSDF.EMA"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tempo.tsdf.TSDF.EMA" title="Link to this definition">¶</a></dt>
<dd><p>Constructs an approximate EMA in the fashion of:
EMA = e * lag(col,0) + e * (1 - e) * lag(col, 1) + e * (1 - e)^2 * lag(col, 2) etc, up until window
TODO: replace case when statement with coalesce
TODO: add in time partitions functionality (what is the overlap fraction?)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tempo.tsdf.TSDF.after">
<span class="sig-name descname"><span class="pre">after</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#tempo.tsdf.TSDF" title="tempo.tsdf.TSDF"><span class="pre">TSDF</span></a></span></span><a class="reference internal" href="../_modules/tempo/tsdf.html#TSDF.after"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tempo.tsdf.TSDF.after" title="Link to this definition">¶</a></dt>
<dd><p>Select only records after a given time</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ts</strong> – timestamp on which to filter records</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a <code class="xref py py-class docutils literal notranslate"><span class="pre">TSDF</span></code> object containing just the records after the given time</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tempo.tsdf.TSDF.asofJoin">
<span class="sig-name descname"><span class="pre">asofJoin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">right_tsdf</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#tempo.tsdf.TSDF" title="tempo.tsdf.TSDF"><span class="pre">TSDF</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">left_prefix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">right_prefix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'right'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tsPartitionVal</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fraction</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skipNulls</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sql_join_opt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">suppress_null_warning</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tolerance</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#tempo.tsdf.TSDF" title="tempo.tsdf.TSDF"><span class="pre">TSDF</span></a></span></span><a class="reference internal" href="../_modules/tempo/tsdf.html#TSDF.asofJoin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tempo.tsdf.TSDF.asofJoin" title="Link to this definition">¶</a></dt>
<dd><p>Performs an as-of join between two time-series. If a tsPartitionVal is
specified, it will do this partitioned by time brackets, which can help alleviate skew.</p>
<p>NOTE: partition cols have to be the same for both Dataframes. We are
collecting stats when the WARNING level is enabled also.</p>
<p>Parameters
:param right_tsdf - right-hand data frame containing columns to merge in
:param left_prefix - optional prefix for base data frame
:param right_prefix - optional prefix for right-hand data frame
:param tsPartitionVal - value to break up each partition into time brackets
:param fraction - overlap fraction
:param skipNulls - whether to skip nulls when joining in values
:param sql_join_opt - if set to True, will use standard Spark SQL join if it is estimated to be efficient
:param suppress_null_warning - when tsPartitionVal is specified, will collect min of each column and raise warnings about null values, set to True to avoid
:param tolerance - only join values within this tolerance range (inclusive), expressed in number of seconds as a double</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tempo.tsdf.TSDF.at">
<span class="sig-name descname"><span class="pre">at</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#tempo.tsdf.TSDF" title="tempo.tsdf.TSDF"><span class="pre">TSDF</span></a></span></span><a class="reference internal" href="../_modules/tempo/tsdf.html#TSDF.at"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tempo.tsdf.TSDF.at" title="Link to this definition">¶</a></dt>
<dd><p>Select only records at a given time</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ts</strong> – timestamp of the records to select</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a <code class="xref py py-class docutils literal notranslate"><span class="pre">TSDF</span></code> object containing just the records at the given time</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tempo.tsdf.TSDF.atOrAfter">
<span class="sig-name descname"><span class="pre">atOrAfter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#tempo.tsdf.TSDF" title="tempo.tsdf.TSDF"><span class="pre">TSDF</span></a></span></span><a class="reference internal" href="../_modules/tempo/tsdf.html#TSDF.atOrAfter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tempo.tsdf.TSDF.atOrAfter" title="Link to this definition">¶</a></dt>
<dd><p>Select only records at or after a given time</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ts</strong> – timestamp on which to filter records</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a <code class="xref py py-class docutils literal notranslate"><span class="pre">TSDF</span></code> object containing just the records at or after the given time</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tempo.tsdf.TSDF.atOrBefore">
<span class="sig-name descname"><span class="pre">atOrBefore</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#tempo.tsdf.TSDF" title="tempo.tsdf.TSDF"><span class="pre">TSDF</span></a></span></span><a class="reference internal" href="../_modules/tempo/tsdf.html#TSDF.atOrBefore"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tempo.tsdf.TSDF.atOrBefore" title="Link to this definition">¶</a></dt>
<dd><p>Select only records at or before a given time</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ts</strong> – timestamp on which to filter records</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a <code class="xref py py-class docutils literal notranslate"><span class="pre">TSDF</span></code> object containing just the records at or before the given time</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tempo.tsdf.TSDF.before">
<span class="sig-name descname"><span class="pre">before</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#tempo.tsdf.TSDF" title="tempo.tsdf.TSDF"><span class="pre">TSDF</span></a></span></span><a class="reference internal" href="../_modules/tempo/tsdf.html#TSDF.before"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tempo.tsdf.TSDF.before" title="Link to this definition">¶</a></dt>
<dd><p>Select only records before a given time</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ts</strong> – timestamp on which to filter records</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a <code class="xref py py-class docutils literal notranslate"><span class="pre">TSDF</span></code> object containing just the records before the given time</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tempo.tsdf.TSDF.between">
<span class="sig-name descname"><span class="pre">between</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start_ts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end_ts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inclusive</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#tempo.tsdf.TSDF" title="tempo.tsdf.TSDF"><span class="pre">TSDF</span></a></span></span><a class="reference internal" href="../_modules/tempo/tsdf.html#TSDF.between"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tempo.tsdf.TSDF.between" title="Link to this definition">¶</a></dt>
<dd><p>Select only records in a given range</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>start_ts</strong> – starting time of the range to select</p></li>
<li><p><strong>end_ts</strong> – ending time of the range to select</p></li>
<li><p><strong>inclusive</strong> (<em>bool</em>) – whether the range is inclusive of the endpoints or not, defaults to True</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a <code class="xref py py-class docutils literal notranslate"><span class="pre">TSDF</span></code> object containing just the records within the range specified</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tempo.tsdf.TSDF.calc_bars">
<span class="sig-name descname"><span class="pre">calc_bars</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metricCols</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#tempo.tsdf.TSDF" title="tempo.tsdf.TSDF"><span class="pre">TSDF</span></a></span></span><a class="reference internal" href="../_modules/tempo/tsdf.html#TSDF.calc_bars"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tempo.tsdf.TSDF.calc_bars" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tempo.tsdf.TSDF.describe">
<span class="sig-name descname"><span class="pre">describe</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="reference internal" href="../_modules/tempo/tsdf.html#TSDF.describe"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tempo.tsdf.TSDF.describe" title="Link to this definition">¶</a></dt>
<dd><p>Describe a TSDF object using a global summary across all time series (anywhere from 10 to millions) as well as the standard Spark data frame stats. Missing vals
Summary
global - unique time series based on partition columns, min/max times, granularity - lowest precision in the time series timestamp column
count / mean / stddev / min / max - standard Spark data frame describe() output
missing_vals_pct - percentage (from 0 to 100) of missing values.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tempo.tsdf.TSDF.earliest">
<span class="sig-name descname"><span class="pre">earliest</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#tempo.tsdf.TSDF" title="tempo.tsdf.TSDF"><span class="pre">TSDF</span></a></span></span><a class="reference internal" href="../_modules/tempo/tsdf.html#TSDF.earliest"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tempo.tsdf.TSDF.earliest" title="Link to this definition">¶</a></dt>
<dd><p>Select the earliest n records for each series</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>n</strong> – number of records to select (default is 1)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a <code class="xref py py-class docutils literal notranslate"><span class="pre">TSDF</span></code> object containing the earliest n records for each series</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tempo.tsdf.TSDF.extractStateIntervals">
<span class="sig-name descname"><span class="pre">extractStateIntervals</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">metric_cols</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_definition</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">Column</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Column</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Column</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'='</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="reference internal" href="../_modules/tempo/tsdf.html#TSDF.extractStateIntervals"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tempo.tsdf.TSDF.extractStateIntervals" title="Link to this definition">¶</a></dt>
<dd><p>Extracts intervals from a <code class="xref py py-class docutils literal notranslate"><span class="pre">TSDF</span></code> based on some notion of “state”, as defined by the :param
state_definition: parameter. The state definition consists of a comparison operation between the current and
previous values of a metric. If the comparison operation evaluates to true across all metric columns,
then we consider both points to be in the same “state”. Changes of state occur when the comparison operator
returns false for any given metric column. So, the default state definition (‘=’) entails that intervals of
time wherein the metrics all remained constant. A state definition of ‘&gt;=’ would extract intervals wherein
the metrics were all monotonically increasing.</p>
<dl class="field-list simple">
<dt class="field-odd">Param<span class="colon">:</span></dt>
<dd class="field-odd"><p>metric_cols: the set of metric columns to evaluate for state changes</p>
</dd>
<dt class="field-even">Param<span class="colon">:</span></dt>
<dd class="field-even"><p>state_definition: the comparison function used to evaluate individual metrics for state changes.</p>
</dd>
</dl>
<p>Either a string, giving a standard PySpark column comparison operation, or a binary function with the
signature: <cite>(x1: Column, x2: Column) -&gt; Column</cite> where the returned column expression evaluates to a
<code class="xref py py-class docutils literal notranslate"><span class="pre">BooleanType</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>a <code class="xref py py-class docutils literal notranslate"><span class="pre">DataFrame</span></code> object containing the resulting intervals</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tempo.tsdf.TSDF.fourier_transform">
<span class="sig-name descname"><span class="pre">fourier_transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">timestep</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">complex</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valueCol</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#tempo.tsdf.TSDF" title="tempo.tsdf.TSDF"><span class="pre">TSDF</span></a></span></span><a class="reference internal" href="../_modules/tempo/tsdf.html#TSDF.fourier_transform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tempo.tsdf.TSDF.fourier_transform" title="Link to this definition">¶</a></dt>
<dd><p>Function to fourier transform the time series to its frequency domain representation.
:param timestep: timestep value to be used for getting the frequency scale
:param valueCol: name of the time domain data column which will be transformed</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tempo.tsdf.TSDF.interpolate">
<span class="sig-name descname"><span class="pre">interpolate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_cols</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ts_col</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">partition_cols</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_interpolated</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">perform_checks</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#tempo.tsdf.TSDF" title="tempo.tsdf.TSDF"><span class="pre">TSDF</span></a></span></span><a class="reference internal" href="../_modules/tempo/tsdf.html#TSDF.interpolate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tempo.tsdf.TSDF.interpolate" title="Link to this definition">¶</a></dt>
<dd><p>Function to interpolate based on frequency, aggregation, and fill similar to pandas. Data will first be aggregated using resample, then missing values
will be filled based on the fill calculation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>freq</strong> – frequency for upsample - valid inputs are “hr”, “min”, “sec” corresponding to hour, minute, or second</p></li>
<li><p><strong>func</strong> – function used to aggregate input</p></li>
<li><p><strong>method</strong> – function used to fill missing values e.g. linear, null, zero, bfill, ffill</p></li>
<li><p><strong>[</strong><strong>optional</strong><strong>]</strong> (<em>show_interpolated</em>) – columns that should be interpolated, by default interpolates all numeric columns</p></li>
<li><p><strong>[</strong><strong>optional</strong><strong>]</strong> – specify other ts_col, by default this uses the ts_col within the TSDF object</p></li>
<li><p><strong>[</strong><strong>optional</strong><strong>]</strong> – specify other partition_cols, by default this uses the partition_cols within the TSDF object</p></li>
<li><p><strong>[</strong><strong>optional</strong><strong>]</strong> – if true will include an additional column to show which rows have been fully interpolated.</p></li>
<li><p><strong>perform_checks</strong> – calculate time horizon and warnings if True (default is True)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>new TSDF object containing interpolated data</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tempo.tsdf.TSDF.latest">
<span class="sig-name descname"><span class="pre">latest</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#tempo.tsdf.TSDF" title="tempo.tsdf.TSDF"><span class="pre">TSDF</span></a></span></span><a class="reference internal" href="../_modules/tempo/tsdf.html#TSDF.latest"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tempo.tsdf.TSDF.latest" title="Link to this definition">¶</a></dt>
<dd><p>Select the latest n records for each series</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>n</strong> – number of records to select (default is 1)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a <code class="xref py py-class docutils literal notranslate"><span class="pre">TSDF</span></code> object containing the latest n records for each series</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tempo.tsdf.TSDF.parse_nanos_timestamp">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">parse_nanos_timestamp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">str_ts_col</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ts_fmt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'yyyy-MM-dd</span> <span class="pre">HH:mm:ss'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">double_ts_col</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parsed_ts_col</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="reference internal" href="../_modules/tempo/tsdf.html#TSDF.parse_nanos_timestamp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tempo.tsdf.TSDF.parse_nanos_timestamp" title="Link to this definition">¶</a></dt>
<dd><p>Parse a string timestamp column with nanosecond precision into a double timestamp column.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> – DataFrame containing the string timestamp column</p></li>
<li><p><strong>str_ts_col</strong> – Name of the string timestamp column</p></li>
<li><p><strong>ts_fmt</strong> – Format of the string timestamp column (default: “yyyy-MM-dd HH:mm:ss”)</p></li>
<li><p><strong>double_ts_col</strong> – Name of the double timestamp column to create, if None
the source string column will be overwritten</p></li>
<li><p><strong>parsed_ts_col</strong> – Name of the parsed timestamp column to create, if None
no parsed timestamp column will be kept</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>DataFrame with the double timestamp column</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tempo.tsdf.TSDF.priorTo">
<span class="sig-name descname"><span class="pre">priorTo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#tempo.tsdf.TSDF" title="tempo.tsdf.TSDF"><span class="pre">TSDF</span></a></span></span><a class="reference internal" href="../_modules/tempo/tsdf.html#TSDF.priorTo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tempo.tsdf.TSDF.priorTo" title="Link to this definition">¶</a></dt>
<dd><p>Select the n most recent records prior to a given time
You can think of this like an ‘asOf’ select - it selects the records as of a particular time</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ts</strong> – timestamp on which to filter records</p></li>
<li><p><strong>n</strong> – number of records to select (default is 1)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a <code class="xref py py-class docutils literal notranslate"><span class="pre">TSDF</span></code> object containing the n records prior to the given time</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tempo.tsdf.TSDF.resample">
<span class="sig-name descname"><span class="pre">resample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metricCols</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">perform_checks</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#tempo.tsdf.TSDF" title="tempo.tsdf.TSDF"><span class="pre">TSDF</span></a></span></span><a class="reference internal" href="../_modules/tempo/tsdf.html#TSDF.resample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tempo.tsdf.TSDF.resample" title="Link to this definition">¶</a></dt>
<dd><p>function to upsample based on frequency and aggregate function similar to pandas
:param freq: frequency for upsample - valid inputs are “hr”, “min”, “sec” corresponding to hour, minute, or second
:param func: function used to aggregate input
:param metricCols supply a smaller list of numeric columns if the entire set of numeric columns should not be returned for the resample function
:param prefix - supply a prefix for the newly sampled columns
:param fill - Boolean - set to True if the desired output should contain filled in gaps (with 0s currently)
:param perform_checks: calculate time horizon and warnings if True (default is True)
:return: TSDF object with sample data using aggregate function</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tempo.tsdf.TSDF.select">
<span class="sig-name descname"><span class="pre">select</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">cols</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#tempo.tsdf.TSDF" title="tempo.tsdf.TSDF"><span class="pre">TSDF</span></a></span></span><a class="reference internal" href="../_modules/tempo/tsdf.html#TSDF.select"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tempo.tsdf.TSDF.select" title="Link to this definition">¶</a></dt>
<dd><p>pyspark.sql.DataFrame.select() method’s equivalent for TSDF objects</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>cols</strong> – str or list of strs column names (string). If one of the column names is ‘*’, that
column is expanded to include all columns in the current <a class="reference internal" href="#tempo.tsdf.TSDF" title="tempo.tsdf.TSDF"><code class="xref py py-class docutils literal notranslate"><span class="pre">TSDF</span></code></a>.</p>
</dd>
</dl>
<p>## Examples
.. code-block:: python
tsdf.select(‘*’).collect()
[Row(age=2, name=’Alice’), Row(age=5, name=’Bob’)]
tsdf.select(‘name’, ‘age’).collect()
[Row(name=’Alice’, age=2), Row(name=’Bob’, age=5)]</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tempo.tsdf.TSDF.show">
<span class="sig-name descname"><span class="pre">show</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">truncate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vertical</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/tempo/tsdf.html#TSDF.show"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tempo.tsdf.TSDF.show" title="Link to this definition">¶</a></dt>
<dd><p>pyspark.sql.DataFrame.show() method’s equivalent for TSDF objects</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> – Number of rows to show. (default: 20)</p></li>
<li><p><strong>truncate</strong> – If set to True, truncate strings longer than 20 chars by default.
If set to a number greater than one, truncates long strings to length truncate
and align cells right.</p></li>
<li><p><strong>vertical</strong> – If set to True, print output rows vertically (one line per column value).</p></li>
</ul>
</dd>
</dl>
<p>## Example to show usage:
.. code-block:: python
from pyspark.sql.functions import *</p>
<p>phone_accel_df = spark.read.format(“csv”).option(“header”, “true”).load(“dbfs:/home/tempo/Phones_accelerometer”)</p>
<blockquote>
<div><p>.withColumn(“event_ts”, (col(“Arrival_Time”).cast(“double”)/1000).cast(“timestamp”))</p>
<p>.withColumn(“x”, col(“x”).cast(“double”))</p>
<p>.withColumn(“y”, col(“y”).cast(“double”))</p>
<p>.withColumn(“z”, col(“z”).cast(“double”))</p>
<p>.withColumn(“event_ts_dbl”, col(“event_ts”).cast(“double”))</p>
</div></blockquote>
<p>from tempo import *</p>
<p>phone_accel_tsdf = TSDF(phone_accel_df, ts_col=”event_ts”, partition_cols = [“User”])</p>
<p># Call show method here
phone_accel_tsdf.show()</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tempo.tsdf.TSDF.subsequentTo">
<span class="sig-name descname"><span class="pre">subsequentTo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#tempo.tsdf.TSDF" title="tempo.tsdf.TSDF"><span class="pre">TSDF</span></a></span></span><a class="reference internal" href="../_modules/tempo/tsdf.html#TSDF.subsequentTo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tempo.tsdf.TSDF.subsequentTo" title="Link to this definition">¶</a></dt>
<dd><p>Select the n records subsequent to a give time</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ts</strong> – timestamp on which to filter records</p></li>
<li><p><strong>n</strong> – number of records to select (default is 1)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a <code class="xref py py-class docutils literal notranslate"><span class="pre">TSDF</span></code> object containing the n records subsequent to the given time</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tempo.tsdf.TSDF.vwap">
<span class="sig-name descname"><span class="pre">vwap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frequency</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'m'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">volume_col</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'volume'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">price_col</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'price'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#tempo.tsdf.TSDF" title="tempo.tsdf.TSDF"><span class="pre">TSDF</span></a></span></span><a class="reference internal" href="../_modules/tempo/tsdf.html#TSDF.vwap"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tempo.tsdf.TSDF.vwap" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tempo.tsdf.TSDF.withGroupedStats">
<span class="sig-name descname"><span class="pre">withGroupedStats</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metricCols</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#tempo.tsdf.TSDF" title="tempo.tsdf.TSDF"><span class="pre">TSDF</span></a></span></span><a class="reference internal" href="../_modules/tempo/tsdf.html#TSDF.withGroupedStats"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tempo.tsdf.TSDF.withGroupedStats" title="Link to this definition">¶</a></dt>
<dd><p>Create a wider set of stats based on all numeric columns by default
Users can choose which columns they want to summarize also. These stats are:
mean/count/min/max/sum/std deviation
:param metricCols - list of user-supplied columns to compute stats for. All numeric columns are used if no list is provided
:param freq - frequency (provide a string of the form ‘1 min’, ‘30 seconds’ and we interpret the window to use to aggregate</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tempo.tsdf.TSDF.withLookbackFeatures">
<span class="sig-name descname"><span class="pre">withLookbackFeatures</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">featureCols</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lookbackWindowSize</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exactSize</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">featureColName</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'features'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="s"><span class="pre">'TSDF'</span></span></span></span><a class="reference internal" href="../_modules/tempo/tsdf.html#TSDF.withLookbackFeatures"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tempo.tsdf.TSDF.withLookbackFeatures" title="Link to this definition">¶</a></dt>
<dd><p>Creates a 2-D feature tensor suitable for training an ML model to predict current values from the history of
some set of features. This function creates a new column containing, for each observation, a 2-D array of the values
of some number of other columns over a trailing “lookback” window from the previous observation up to some maximum
number of past observations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>featureCols</strong> – the names of one or more feature columns to be aggregated into the feature column</p></li>
<li><p><strong>lookbackWindowSize</strong> – The size of lookback window (in terms of past observations). Must be an integer &gt;= 1</p></li>
<li><p><strong>exactSize</strong> – If True (the default), then the resulting DataFrame will only include observations where the
generated feature column contains arrays of length lookbackWindowSize. This implies that it will truncate
observations that occurred less than lookbackWindowSize from the start of the timeseries. If False, no truncation
occurs, and the column may contain arrays less than lookbackWindowSize in length.</p></li>
<li><p><strong>featureColName</strong> – The name of the feature column to be generated. Defaults to “features”</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a DataFrame with a feature column named featureColName containing the lookback feature tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tempo.tsdf.TSDF.withPartitionCols">
<span class="sig-name descname"><span class="pre">withPartitionCols</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">partitionCols</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#tempo.tsdf.TSDF" title="tempo.tsdf.TSDF"><span class="pre">TSDF</span></a></span></span><a class="reference internal" href="../_modules/tempo/tsdf.html#TSDF.withPartitionCols"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tempo.tsdf.TSDF.withPartitionCols" title="Link to this definition">¶</a></dt>
<dd><p>Sets certain columns of the TSDF as partition columns. Partition columns are those that differentiate distinct timeseries
from each other.
:param partitionCols: a list of columns used to partition distinct timeseries
:return: a TSDF object with the given partition columns</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tempo.tsdf.TSDF.withRangeStats">
<span class="sig-name descname"><span class="pre">withRangeStats</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'range'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colsToSummarize</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Column</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rangeBackWindowSecs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1000</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#tempo.tsdf.TSDF" title="tempo.tsdf.TSDF"><span class="pre">TSDF</span></a></span></span><a class="reference internal" href="../_modules/tempo/tsdf.html#TSDF.withRangeStats"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tempo.tsdf.TSDF.withRangeStats" title="Link to this definition">¶</a></dt>
<dd><p>Create a wider set of stats based on all numeric columns by default
Users can choose which columns they want to summarize also. These stats are:
mean/count/min/max/sum/std deviation/zscore
:param type - this is created in case we want to extend these stats to lookback over a fixed number of rows instead of ranging over column values
:param colsToSummarize - list of user-supplied columns to compute stats for. All numeric columns are used if no list is provided
:param rangeBackWindowSecs - lookback this many seconds in time to summarize all stats. Note this will look back from the floor of the base event timestamp (as opposed to the exact time since we cast to long)
Assumptions:</p>
<ol class="arabic simple">
<li><p>The features are summarized over a rolling window that ranges back</p></li>
<li><p>The range back window can be specified by the user</p></li>
<li><p>Sequence numbers are not yet supported for the sort</p></li>
<li><p>There is a cast to long from timestamp so microseconds or more likely breaks down - this could be more easily handled with a string timestamp or sorting the timestamp itself. If using a ‘rows preceding’ window, this wouldn’t be a problem</p></li>
</ol>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tempo.tsdf.TSDF.write">
<span class="sig-name descname"><span class="pre">write</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spark</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">SparkSession</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tabName</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizationCols</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/tempo/tsdf.html#TSDF.write"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tempo.tsdf.TSDF.write" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="intervals.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Intervals Module</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="api-reference.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">API Reference</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2024, Databricks Labs
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              <a class="muted-link " href="https://github.com/databrickslabs/tempo" aria-label="GitHub">
                <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16">
                    <path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"></path>
                </svg>
            </a>
              <a class="muted-link fa-brands fa-uncharted" href="https://databricks.com/learn/labs" aria-label="Databricks Labs"></a>
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">TSDF Module</a><ul>
<li><a class="reference internal" href="#tempo.tsdf.Comparable"><code class="docutils literal notranslate"><span class="pre">Comparable</span></code></a></li>
<li><a class="reference internal" href="#tempo.tsdf.TSDF"><code class="docutils literal notranslate"><span class="pre">TSDF</span></code></a><ul>
<li><a class="reference internal" href="#tempo.tsdf.TSDF.EMA"><code class="docutils literal notranslate"><span class="pre">TSDF.EMA()</span></code></a></li>
<li><a class="reference internal" href="#tempo.tsdf.TSDF.after"><code class="docutils literal notranslate"><span class="pre">TSDF.after()</span></code></a></li>
<li><a class="reference internal" href="#tempo.tsdf.TSDF.asofJoin"><code class="docutils literal notranslate"><span class="pre">TSDF.asofJoin()</span></code></a></li>
<li><a class="reference internal" href="#tempo.tsdf.TSDF.at"><code class="docutils literal notranslate"><span class="pre">TSDF.at()</span></code></a></li>
<li><a class="reference internal" href="#tempo.tsdf.TSDF.atOrAfter"><code class="docutils literal notranslate"><span class="pre">TSDF.atOrAfter()</span></code></a></li>
<li><a class="reference internal" href="#tempo.tsdf.TSDF.atOrBefore"><code class="docutils literal notranslate"><span class="pre">TSDF.atOrBefore()</span></code></a></li>
<li><a class="reference internal" href="#tempo.tsdf.TSDF.before"><code class="docutils literal notranslate"><span class="pre">TSDF.before()</span></code></a></li>
<li><a class="reference internal" href="#tempo.tsdf.TSDF.between"><code class="docutils literal notranslate"><span class="pre">TSDF.between()</span></code></a></li>
<li><a class="reference internal" href="#tempo.tsdf.TSDF.calc_bars"><code class="docutils literal notranslate"><span class="pre">TSDF.calc_bars()</span></code></a></li>
<li><a class="reference internal" href="#tempo.tsdf.TSDF.describe"><code class="docutils literal notranslate"><span class="pre">TSDF.describe()</span></code></a></li>
<li><a class="reference internal" href="#tempo.tsdf.TSDF.earliest"><code class="docutils literal notranslate"><span class="pre">TSDF.earliest()</span></code></a></li>
<li><a class="reference internal" href="#tempo.tsdf.TSDF.extractStateIntervals"><code class="docutils literal notranslate"><span class="pre">TSDF.extractStateIntervals()</span></code></a></li>
<li><a class="reference internal" href="#tempo.tsdf.TSDF.fourier_transform"><code class="docutils literal notranslate"><span class="pre">TSDF.fourier_transform()</span></code></a></li>
<li><a class="reference internal" href="#tempo.tsdf.TSDF.interpolate"><code class="docutils literal notranslate"><span class="pre">TSDF.interpolate()</span></code></a></li>
<li><a class="reference internal" href="#tempo.tsdf.TSDF.latest"><code class="docutils literal notranslate"><span class="pre">TSDF.latest()</span></code></a></li>
<li><a class="reference internal" href="#tempo.tsdf.TSDF.parse_nanos_timestamp"><code class="docutils literal notranslate"><span class="pre">TSDF.parse_nanos_timestamp()</span></code></a></li>
<li><a class="reference internal" href="#tempo.tsdf.TSDF.priorTo"><code class="docutils literal notranslate"><span class="pre">TSDF.priorTo()</span></code></a></li>
<li><a class="reference internal" href="#tempo.tsdf.TSDF.resample"><code class="docutils literal notranslate"><span class="pre">TSDF.resample()</span></code></a></li>
<li><a class="reference internal" href="#tempo.tsdf.TSDF.select"><code class="docutils literal notranslate"><span class="pre">TSDF.select()</span></code></a></li>
<li><a class="reference internal" href="#tempo.tsdf.TSDF.show"><code class="docutils literal notranslate"><span class="pre">TSDF.show()</span></code></a></li>
<li><a class="reference internal" href="#tempo.tsdf.TSDF.subsequentTo"><code class="docutils literal notranslate"><span class="pre">TSDF.subsequentTo()</span></code></a></li>
<li><a class="reference internal" href="#tempo.tsdf.TSDF.vwap"><code class="docutils literal notranslate"><span class="pre">TSDF.vwap()</span></code></a></li>
<li><a class="reference internal" href="#tempo.tsdf.TSDF.withGroupedStats"><code class="docutils literal notranslate"><span class="pre">TSDF.withGroupedStats()</span></code></a></li>
<li><a class="reference internal" href="#tempo.tsdf.TSDF.withLookbackFeatures"><code class="docutils literal notranslate"><span class="pre">TSDF.withLookbackFeatures()</span></code></a></li>
<li><a class="reference internal" href="#tempo.tsdf.TSDF.withPartitionCols"><code class="docutils literal notranslate"><span class="pre">TSDF.withPartitionCols()</span></code></a></li>
<li><a class="reference internal" href="#tempo.tsdf.TSDF.withRangeStats"><code class="docutils literal notranslate"><span class="pre">TSDF.withRangeStats()</span></code></a></li>
<li><a class="reference internal" href="#tempo.tsdf.TSDF.write"><code class="docutils literal notranslate"><span class="pre">TSDF.write()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=904119ea"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=5fa4622c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    </body>
</html>