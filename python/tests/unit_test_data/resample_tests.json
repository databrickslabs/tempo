{
  "__SharedData": {
    "input_data": {
      "schema": "symbol string, date string, event_ts string, trade_pr float, trade_pr_2 float",
      "ts_col": "event_ts",
      "partition_cols": [
        "symbol"
      ],
      "data": [
        [
          "S1",
          "SAME_DT",
          "2020-08-01 00:00:10",
          349.21,
          10.0
        ],
        [
          "S1",
          "SAME_DT",
          "2020-08-01 00:00:11",
          340.21,
          9.0
        ],
        [
          "S1",
          "SAME_DT",
          "2020-08-01 00:01:12",
          353.32,
          8.0
        ],
        [
          "S1",
          "SAME_DT",
          "2020-08-01 00:01:13",
          351.32,
          7.0
        ],
        [
          "S1",
          "SAME_DT",
          "2020-08-01 00:01:14",
          350.32,
          6.0
        ],
        [
          "S1",
          "SAME_DT",
          "2020-09-01 00:01:12",
          361.1,
          5.0
        ],
        [
          "S1",
          "SAME_DT",
          "2020-09-01 00:19:12",
          362.1,
          4.0
        ]
      ]
    }
  },
  "ResampleUnitTests": {
    "test_appendAggKey_freq_is_none": {
      "input_data": {
        "$ref": "#/__SharedData/input_data"
      }
    },
    "test_appendAggKey_freq_microsecond": {
      "input_data": {
        "$ref": "#/__SharedData/input_data"
      }
    },
    "test_appendAggKey_freq_day": {
      "input_data": {
        "$ref": "#/__SharedData/input_data"
      }
    },
    "test_aggregate_floor": {
      "input_data": {
        "$ref": "#/__SharedData/input_data"
      },
      "expected_data": {
        "schema": "symbol string, event_ts string, date string, trade_pr float, trade_pr_2 float",
        "ts_col": "event_ts",
        "partition_cols": [
          "symbol"
        ],
        "data": [
          [
            "S1",
            "2020-07-31 20:00:00",
            "SAME_DT",
            349.21,
            10.0
          ],
          [
            "S1",
            "2020-08-31 20:00:00",
            "SAME_DT",
            361.1,
            5.0
          ]
        ]
      }
    },
    "test_aggregate_average": {
      "input_data": {
        "$ref": "#/__SharedData/input_data"
      },
      "expected_data": {
        "schema": "symbol string, event_ts string, date string, trade_pr float, trade_pr_2 float",
        "ts_col": "event_ts",
        "partition_cols": [
          "symbol"
        ],
        "data": [
          [
            "S1",
            "2020-07-31 20:00:00",
            "SAME_DT",
            349.21,
            10.0
          ],
          [
            "S1",
            "2020-08-31 20:00:00",
            "SAME_DT",
            361.1,
            5.0
          ]
        ]
      }
    },
    "test_aggregate_min": {
      "input_data": {
        "$ref": "#/__SharedData/input_data"
      },
      "expected_data": {
        "schema": "symbol string, event_ts string, date string, trade_pr float, trade_pr_2 float",
        "ts_col": "event_ts",
        "partition_cols": [
          "symbol"
        ],
        "data": [
          [
            "S1",
            "2020-07-31 20:00:00",
            "SAME_DT",
            340.21,
            6.0
          ],
          [
            "S1",
            "2020-08-31 20:00:00",
            "SAME_DT",
            361.1,
            4.0
          ]
        ]
      }
    },
    "test_aggregate_max": {
      "input_data": {
        "$ref": "#/__SharedData/input_data"
      },
      "expected_data": {
        "schema": "symbol string, event_ts string, date string, trade_pr float, trade_pr_2 float",
        "ts_col": "event_ts",
        "partition_cols": [
          "symbol"
        ],
        "data": [
          [
            "S1",
            "2020-07-31 20:00:00",
            "SAME_DT",
            353.32,
            10.0
          ],
          [
            "S1",
            "2020-08-31 20:00:00",
            "SAME_DT",
            362.1,
            5.0
          ]
        ]
      }
},
    "test_aggregate_ceiling": {
      "input_data": {
        "$ref": "#/__SharedData/input_data"
      },
      "expected_data": {
        "schema": "symbol string, event_ts string, date string, trade_pr float, trade_pr_2 float",
        "ts_col": "event_ts",
        "partition_cols": [
          "symbol"
        ],
        "data": [
          [
            "S1",
            "2020-07-31 20:00:00",
            "SAME_DT",
            350.32,
            6.0
          ],
          [
            "S1",
            "2020-08-31 20:00:00",
            "SAME_DT",
            362.1,
            4.0
          ]
        ]
      }
},
    "test_aggregate_invalid_func_arg": {
      "input_data": {
        "$ref": "#/__SharedData/input_data"
      },
      "expected_data": {
        "schema": "symbol string, event_ts string, date string, trade_pr float, trade_pr_2 float",
        "ts_col": "event_ts",
        "partition_cols": [
          "symbol"
        ],
        "data": [
          [
            "S1",
            "2020-07-31 20:00:00",
            "SAME_DT",
            348.88,
            8.0
          ],
          [
            "S1",
            "2020-08-31 20:00:00",
            "SAME_DT",
            361.60,
            4.5
          ]
        ]
      }
    }
  }
}