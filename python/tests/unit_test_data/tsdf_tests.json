{
  "__SharedData": {
    "temp_slice_init_data": {
      "schema": "symbol string, event_ts string, trade_pr float",
      "ts_col": "event_ts",
      "partition_cols": [
        "symbol"
      ],
      "data": [
        [
          "S1",
          "2020-08-01 00:00:10",
          349.21
        ],
        [
          "S1",
          "2020-08-01 00:01:12",
          351.32
        ],
        [
          "S1",
          "2020-09-01 00:02:10",
          361.1
        ],
        [
          "S1",
          "2020-09-01 00:19:12",
          362.1
        ],
        [
          "S2",
          "2020-08-01 00:01:10",
          743.01
        ],
        [
          "S2",
          "2020-08-01 00:01:24",
          751.92
        ],
        [
          "S2",
          "2020-09-01 00:02:10",
          761.10
        ],
        [
          "S2",
          "2020-09-01 00:20:42",
          762.33
        ]
      ]
    }
  },
  "BasicTests": {
    "test_describe": {
      "init": {
        "schema": "symbol string, event_ts string, trade_pr float",
        "ts_col": "event_ts",
        "partition_cols": [
          "symbol"
        ],
        "data": [
          [
            "S1",
            "2020-08-01 00:00:10",
            349.21
          ],
          [
            "S1",
            "2020-08-01 00:01:12",
            351.32
          ],
          [
            "S1",
            "2020-09-01 00:02:10",
            361.1
          ],
          [
            "S1",
            "2020-09-01 00:19:12",
            362.1
          ]
        ]
      }
    },
    "test_at": {
      "init": {
        "$ref": "#/__SharedData/temp_slice_init_data"
      },
      "expected": {
        "schema": "symbol string, event_ts string, trade_pr float",
        "ts_col": "event_ts",
        "partition_cols": [
          "symbol"
        ],
        "data": [
          [
            "S1",
            "2020-09-01 00:02:10",
            361.1
          ],
          [
            "S2",
            "2020-09-01 00:02:10",
            761.10
          ]
        ]
      }
    },
    "test_before": {
      "init": {
        "$ref": "#/__SharedData/temp_slice_init_data"
      },
      "expected": {
        "schema": "symbol string, event_ts string, trade_pr float",
        "ts_col": "event_ts",
        "partition_cols": [
          "symbol"
        ],
        "data": [
          [
            "S1",
            "2020-08-01 00:00:10",
            349.21
          ],
          [
            "S1",
            "2020-08-01 00:01:12",
            351.32
          ],
          [
            "S2",
            "2020-08-01 00:01:10",
            743.01
          ],
          [
            "S2",
            "2020-08-01 00:01:24",
            751.92
          ]
        ]
      }
    },
    "test_atOrBefore": {
      "init": {
        "$ref": "#/__SharedData/temp_slice_init_data"
      },
      "expected": {
        "schema": "symbol string, event_ts string, trade_pr float",
        "ts_col": "event_ts",
        "partition_cols": [
          "symbol"
        ],
        "data": [
          [
            "S1",
            "2020-08-01 00:00:10",
            349.21
          ],
          [
            "S1",
            "2020-08-01 00:01:12",
            351.32
          ],
          [
            "S1",
            "2020-09-01 00:02:10",
            361.1
          ],
          [
            "S2",
            "2020-08-01 00:01:10",
            743.01
          ],
          [
            "S2",
            "2020-08-01 00:01:24",
            751.92
          ],
          [
            "S2",
            "2020-09-01 00:02:10",
            761.10
          ]
        ]
      }
    },
    "test_after": {
      "init": {
        "$ref": "#/__SharedData/temp_slice_init_data"
      },
      "expected": {
        "schema": "symbol string, event_ts string, trade_pr float",
        "ts_col": "event_ts",
        "partition_cols": [
          "symbol"
        ],
        "data": [
          [
            "S1",
            "2020-09-01 00:19:12",
            362.1
          ],
          [
            "S2",
            "2020-09-01 00:20:42",
            762.33
          ]
        ]
      }
    },
    "test_atOrAfter": {
      "init": {
        "$ref": "#/__SharedData/temp_slice_init_data"
      },
      "expected": {
        "schema": "symbol string, event_ts string, trade_pr float",
        "ts_col": "event_ts",
        "partition_cols": [
          "symbol"
        ],
        "data": [
          [
            "S1",
            "2020-09-01 00:02:10",
            361.1
          ],
          [
            "S1",
            "2020-09-01 00:19:12",
            362.1
          ],
          [
            "S2",
            "2020-09-01 00:02:10",
            761.10
          ],
          [
            "S2",
            "2020-09-01 00:20:42",
            762.33
          ]
        ]
      }
    },
    "test_between": {
      "init": {
        "$ref": "#/__SharedData/temp_slice_init_data"
      },
      "expected": {
        "schema": "symbol string, event_ts string, trade_pr float",
        "ts_col": "event_ts",
        "partition_cols": [
          "symbol"
        ],
        "data": [
          [
            "S1",
            "2020-08-01 00:01:12",
            351.32
          ],
          [
            "S1",
            "2020-09-01 00:02:10",
            361.1
          ],
          [
            "S2",
            "2020-08-01 00:01:10",
            743.01
          ],
          [
            "S2",
            "2020-08-01 00:01:24",
            751.92
          ],
          [
            "S2",
            "2020-09-01 00:02:10",
            761.10
          ]
        ]
      }
    },
    "test_between_exclusive": {
      "init": {
        "$ref": "#/__SharedData/temp_slice_init_data"
      },
      "expected": {
        "schema": "symbol string, event_ts string, trade_pr float",
        "ts_col": "event_ts",
        "partition_cols": [
          "symbol"
        ],
        "data": [
          [
            "S1",
            "2020-08-01 00:01:12",
            351.32
          ],
          [
            "S1",
            "2020-09-01 00:02:10",
            361.1
          ],
          [
            "S2",
            "2020-08-01 00:01:24",
            751.92
          ],
          [
            "S2",
            "2020-09-01 00:02:10",
            761.10
          ]
        ]
      }
    },
    "test_earliest": {
      "init": {
        "$ref": "#/__SharedData/temp_slice_init_data"
      },
      "expected": {
        "schema": "symbol string, event_ts string, trade_pr float",
        "ts_col": "event_ts",
        "partition_cols": [
          "symbol"
        ],
        "data": [
          [
            "S1",
            "2020-08-01 00:00:10",
            349.21
          ],
          [
            "S1",
            "2020-08-01 00:01:12",
            351.32
          ],
          [
            "S1",
            "2020-09-01 00:02:10",
            361.1
          ],
          [
            "S2",
            "2020-08-01 00:01:10",
            743.01
          ],
          [
            "S2",
            "2020-08-01 00:01:24",
            751.92
          ],
          [
            "S2",
            "2020-09-01 00:02:10",
            761.10
          ]
        ]
      }
    },
    "test_latest": {
      "init": {
        "$ref": "#/__SharedData/temp_slice_init_data"
      },
      "expected": {
        "schema": "symbol string, event_ts string, trade_pr float",
        "ts_col": "event_ts",
        "partition_cols": [
          "symbol"
        ],
        "data": [
          [
            "S1",
            "2020-08-01 00:01:12",
            351.32
          ],
          [
            "S1",
            "2020-09-01 00:02:10",
            361.1
          ],
          [
            "S1",
            "2020-09-01 00:19:12",
            362.1
          ],
          [
            "S2",
            "2020-08-01 00:01:24",
            751.92
          ],
          [
            "S2",
            "2020-09-01 00:02:10",
            761.10
          ],
          [
            "S2",
            "2020-09-01 00:20:42",
            762.33
          ]
        ]
      }
    },
    "test_priorTo": {
      "init": {
        "$ref": "#/__SharedData/temp_slice_init_data"
      },
      "expected": {
        "schema": "symbol string, event_ts string, trade_pr float",
        "ts_col": "event_ts",
        "partition_cols": [
          "symbol"
        ],
        "data": [
          [
            "S1",
            "2020-08-01 00:01:12",
            351.32
          ],
          [
            "S2",
            "2020-08-01 00:01:24",
            751.92
          ]
        ]
      }
    },
    "test_subsequentTo": {
      "init": {
        "$ref": "#/__SharedData/temp_slice_init_data"
      },
      "expected": {
        "schema": "symbol string, event_ts string, trade_pr float",
        "ts_col": "event_ts",
        "partition_cols": [
          "symbol"
        ],
        "data": [
          [
            "S1",
            "2020-09-01 00:02:10",
            361.1
          ],
          [
            "S2",
            "2020-09-01 00:02:10",
            761.10
          ]
        ]
      }
    }
  },
  "FourierTransformTest": {
    "test_fourier_transform": {
      "init": {
        "schema": "group string, time long, val double",
        "ts_col": "time",
        "partition_cols": [
          "group"
        ],
        "data": [
          [
            "Emissions",
            1949,
            2206.690829
          ],
          [
            "Emissions",
            1950,
            2382.046176
          ],
          [
            "Emissions",
            1951,
            2526.687327
          ],
          [
            "Emissions",
            1952,
            2473.373964
          ],
          [
            "WindGen",
            1980,
            0.0
          ],
          [
            "WindGen",
            1981,
            0.0
          ],
          [
            "WindGen",
            1982,
            0.0
          ],
          [
            "WindGen",
            1983,
            0.029667962
          ]
        ]
      },
      "expected": {
        "schema": "group string, time long, val double, freq double, ft_real double, ft_imag double",
        "ts_col": "time",
        "partition_cols": [
          "group"
        ],
        "data": [
          [
            "Emissions",
            1949,
            2206.690829,
            0.0,
            9588.798296,
            -0.0
          ],
          [
            "Emissions",
            1950,
            2382.046176,
            0.25,
            -319.996498,
            91.32778800000006
          ],
          [
            "Emissions",
            1951,
            2526.687327,
            -0.5,
            -122.0419839999995,
            -0.0
          ],
          [
            "Emissions",
            1952,
            2473.373964,
            -0.25,
            -319.996498,
            -91.32778800000006
          ],
          [
            "WindGen",
            1980,
            0.0,
            0.0,
            0.029667962,
            -0.0
          ],
          [
            "WindGen",
            1981,
            0.0,
            0.25,
            0.0,
            0.029667962
          ],
          [
            "WindGen",
            1982,
            0.0,
            -0.5,
            -0.029667962,
            -0.0
          ],
          [
            "WindGen",
            1983,
            0.029667962,
            -0.25,
            0.0,
            -0.029667962
          ]
        ]
      }
    }
  },
  "RangeStatsTest": {
    "test_range_stats": {
      "init": {
        "schema": "symbol string, event_ts string, trade_pr float",
        "ts_col": "event_ts",
        "partition_cols": [
          "symbol"
        ],
        "data": [
          [
            "S1",
            "2020-08-01 00:00:10",
            349.21
          ],
          [
            "S1",
            "2020-08-01 00:01:12",
            351.32
          ],
          [
            "S1",
            "2020-09-01 00:02:10",
            361.1
          ],
          [
            "S1",
            "2020-09-01 00:19:12",
            362.1
          ]
        ]
      },
      "expected": {
        "schema": "symbol string, event_ts string, mean_trade_pr float, count_trade_pr long, min_trade_pr float, max_trade_pr float, sum_trade_pr float, stddev_trade_pr float, zscore_trade_pr float",
        "ts_col": "event_ts",
        "partition_cols": [
          "symbol"
        ],
        "data": [
          [
            "S1",
            "2020-08-01 00:00:10",
            349.21,
            1,
            349.21,
            349.21,
            349.21,
            null,
            null
          ],
          [
            "S1",
            "2020-08-01 00:01:12",
            350.26,
            2,
            349.21,
            351.32,
            700.53,
            1.49,
            0.71
          ],
          [
            "S1",
            "2020-09-01 00:02:10",
            361.1,
            1,
            361.1,
            361.1,
            361.1,
            null,
            null
          ],
          [
            "S1",
            "2020-09-01 00:19:12",
            361.6,
            2,
            361.1,
            362.1,
            723.2,
            0.71,
            0.71
          ]
        ]
      }
    },
    "test_group_stats": {
      "init": {
        "schema": "symbol string, event_ts string, trade_pr float, index integer",
        "ts_col": "event_ts",
        "partition_cols": [
          "symbol"
        ],
        "data": [
          [
            "S1",
            "2020-08-01 00:00:10",
            349.21,
            1
          ],
          [
            "S1",
            "2020-08-01 00:00:33",
            351.32,
            1
          ],
          [
            "S1",
            "2020-09-01 00:02:10",
            361.1,
            1
          ],
          [
            "S1",
            "2020-09-01 00:02:49",
            362.1,
            1
          ]
        ]
      },
      "expected": {
        "schema": "symbol string, event_ts string, mean_trade_pr float, count_trade_pr long, min_trade_pr float, max_trade_pr float, sum_trade_pr float, stddev_trade_pr float, mean_index integer, count_index integer, min_index integer, max_index integer, sum_index integer, stddev_index integer",
        "ts_col": "event_ts",
        "partition_cols": [
          "symbol"
        ],
        "data": [
          [
            "S1",
            "2020-08-01 00:00:00",
            350.26,
            2,
            349.21,
            351.32,
            700.53,
            1.49,
            1,
            2,
            1,
            1,
            2,
            0
          ],
          [
            "S1",
            "2020-09-01 00:02:00",
            361.6,
            2,
            361.1,
            362.1,
            723.2,
            0.71,
            1,
            2,
            1,
            1,
            2,
            0
          ]
        ]
      }
    }
  },
  "ResampleTest": {
    "test_resample": {
      "input": {
        "schema": "symbol string, date string, event_ts string, trade_pr float, trade_pr_2 float",
        "ts_col": "event_ts",
        "partition_cols": [
          "symbol"
        ],
        "data": [
          [
            "S1",
            "SAME_DT",
            "2020-08-01 00:00:10",
            349.21,
            10.0
          ],
          [
            "S1",
            "SAME_DT",
            "2020-08-01 00:00:11",
            340.21,
            9.0
          ],
          [
            "S1",
            "SAME_DT",
            "2020-08-01 00:01:12",
            353.32,
            8.0
          ],
          [
            "S1",
            "SAME_DT",
            "2020-08-01 00:01:13",
            351.32,
            7.0
          ],
          [
            "S1",
            "SAME_DT",
            "2020-08-01 00:01:14",
            350.32,
            6.0
          ],
          [
            "S1",
            "SAME_DT",
            "2020-09-01 00:01:12",
            361.1,
            5.0
          ],
          [
            "S1",
            "SAME_DT",
            "2020-09-01 00:19:12",
            362.1,
            4.0
          ]
        ]
      },
      "expected": {
        "schema": "symbol string, event_ts string, floor_trade_pr float, floor_date string, floor_trade_pr_2 float",
        "ts_col": "event_ts",
        "partition_cols": [
          "symbol"
        ],
        "data": [
          [
            "S1",
            "2020-08-01 00:00:00",
            349.21,
            "SAME_DT",
            10.0
          ],
          [
            "S1",
            "2020-08-01 00:01:00",
            353.32,
            "SAME_DT",
            8.0
          ],
          [
            "S1",
            "2020-09-01 00:01:00",
            361.1,
            "SAME_DT",
            5.0
          ],
          [
            "S1",
            "2020-09-01 00:19:00",
            362.1,
            "SAME_DT",
            4.0
          ]
        ]
      },
      "expected30m": {
        "schema": "symbol string, event_ts string, date double, trade_pr double, trade_pr_2 double",
        "ts_col": "event_ts",
        "partition_cols": [
          "symbol"
        ],
        "data": [
          [
            "S1",
            "2020-08-01 00:00:00",
            null,
            348.88,
            8.0
          ],
          [
            "S1",
            "2020-09-01 00:00:00",
            null,
            361.1,
            5.0
          ],
          [
            "S1",
            "2020-09-01 00:15:00",
            null,
            362.1,
            4.0
          ]
        ]
      },
      "expectedbars": {
        "schema": "symbol string, event_ts string, close_trade_pr float, close_trade_pr_2 float, high_trade_pr float, high_trade_pr_2 float, low_trade_pr float, low_trade_pr_2 float, open_trade_pr float, open_trade_pr_2 float",
        "ts_col": "event_ts",
        "partition_cols": [
          "symbol"
        ],
        "data": [
          [
            "S1",
            "2020-08-01 00:00:00",
            340.21,
            9.0,
            349.21,
            10.0,
            340.21,
            9.0,
            349.21,
            10.0
          ],
          [
            "S1",
            "2020-08-01 00:01:00",
            350.32,
            6.0,
            353.32,
            8.0,
            350.32,
            6.0,
            353.32,
            8.0
          ],
          [
            "S1",
            "2020-09-01 00:01:00",
            361.1,
            5.0,
            361.1,
            5.0,
            361.1,
            5.0,
            361.1,
            5.0
          ],
          [
            "S1",
            "2020-09-01 00:19:00",
            362.1,
            4.0,
            362.1,
            4.0,
            362.1,
            4.0,
            362.1,
            4.0
          ]
        ]
      }
    },
    "test_resample_millis": {
      "init": {
        "schema": "symbol string, date string, event_ts string, trade_pr float, trade_pr_2 float",
        "ts_col": "event_ts",
        "partition_cols": [
          "symbol"
        ],
        "data": [
          [
            "S1",
            "SAME_DT",
            "2020-08-01 00:00:10.12345",
            349.21,
            10.0
          ],
          [
            "S1",
            "SAME_DT",
            "2020-08-01 00:00:10.123",
            340.21,
            9.0
          ],
          [
            "S1",
            "SAME_DT",
            "2020-08-01 00:00:10.124",
            353.32,
            8.0
          ]
        ]
      },
      "expectedms": {
        "schema": "symbol string, event_ts string, date double, trade_pr double, trade_pr_2 double",
        "ts_col": "event_ts",
        "partition_cols": [
          "symbol"
        ],
        "data": [
          [
            "S1",
            "2020-08-01 00:00:10.123",
            null,
            344.71,
            9.5
          ],
          [
            "S1",
            "2020-08-01 00:00:10.124",
            null,
            353.32,
            8.0
          ]
        ]
      }
    },
    "test_upsample": {
      "input": {
        "schema": "symbol string, date string, event_ts string, trade_pr float, trade_pr_2 float",
        "ts_col": "event_ts",
        "partition_cols": [
          "symbol"
        ],
        "data": [
          [
            "S1",
            "SAME_DT",
            "2020-08-01 00:00:10",
            349.21,
            10.0
          ],
          [
            "S1",
            "SAME_DT",
            "2020-08-01 00:00:11",
            340.21,
            9.0
          ],
          [
            "S1",
            "SAME_DT",
            "2020-08-01 00:01:12",
            353.32,
            8.0
          ],
          [
            "S1",
            "SAME_DT",
            "2020-08-01 00:01:13",
            351.32,
            7.0
          ],
          [
            "S1",
            "SAME_DT",
            "2020-08-01 00:01:14",
            350.32,
            6.0
          ],
          [
            "S1",
            "SAME_DT",
            "2020-09-01 00:01:12",
            361.1,
            5.0
          ],
          [
            "S1",
            "SAME_DT",
            "2020-09-01 00:19:12",
            362.1,
            4.0
          ]
        ]
      },
      "expected": {
        "schema": "symbol string, event_ts string, floor_trade_pr float, floor_date string, floor_trade_pr_2 float",
        "ts_col": "event_ts",
        "partition_cols": [
          "symbol"
        ],
        "data": [
          [
            "S1",
            "2020-08-01 00:00:00",
            349.21,
            "SAME_DT",
            10.0
          ],
          [
            "S1",
            "2020-08-01 00:01:00",
            353.32,
            "SAME_DT",
            8.0
          ],
          [
            "S1",
            "2020-09-01 00:01:00",
            361.1,
            "SAME_DT",
            5.0
          ],
          [
            "S1",
            "2020-09-01 00:19:00",
            362.1,
            "SAME_DT",
            4.0
          ]
        ]
      },
      "expected30m": {
        "schema": "symbol string, event_ts string, date double, trade_pr double, trade_pr_2 double",
        "ts_col": "event_ts",
        "partition_cols": [
          "symbol"
        ],
        "data": [
          [
            "S1",
            "2020-08-01 00:00:00",
            0.0,
            348.88,
            8.0
          ],
          [
            "S1",
            "2020-08-01 00:05:00",
            0.0,
            0.0,
            0.0
          ],
          [
            "S1",
            "2020-09-01 00:00:00",
            0.0,
            361.1,
            5.0
          ],
          [
            "S1",
            "2020-09-01 00:15:00",
            0.0,
            362.1,
            4.0
          ]
        ]
      },
      "expectedbars": {
        "schema": "symbol string, event_ts string, close_trade_pr float, close_trade_pr_2 float, high_trade_pr float, high_trade_pr_2 float, low_trade_pr float, low_trade_pr_2 float, open_trade_pr float, open_trade_pr_2 float",
        "ts_col": "event_ts",
        "partition_cols": [
          "symbol"
        ],
        "data": [
          [
            "S1",
            "2020-08-01 00:00:00",
            340.21,
            9.0,
            349.21,
            10.0,
            340.21,
            9.0,
            349.21,
            10.0
          ],
          [
            "S1",
            "2020-08-01 00:01:00",
            350.32,
            6.0,
            353.32,
            8.0,
            350.32,
            6.0,
            353.32,
            8.0
          ],
          [
            "S1",
            "2020-09-01 00:01:00",
            361.1,
            5.0,
            361.1,
            5.0,
            361.1,
            5.0,
            361.1,
            5.0
          ],
          [
            "S1",
            "2020-09-01 00:19:00",
            362.1,
            4.0,
            362.1,
            4.0,
            362.1,
            4.0,
            362.1,
            4.0
          ]
        ]
      }
    }
  },
  "ExtractStateIntervalsTest": {
    "test_eq_0": {
      "input": {
        "schema": "event_ts STRING NOT NULL, identifier_1 STRING NOT NULL, identifier_2 STRING NOT NULL, identifier_3 STRING NOT NULL, metric_1 FLOAT NOT NULL, metric_2 FLOAT NOT NULL, metric_3 FLOAT NOT NULL",
        "ts_col": "event_ts",
        "partition_cols": [
          "identifier_1",
          "identifier_2",
          "identifier_3"
        ],
        "data": [
          [
            "2020-08-01 00:00:09",
            "v1",
            "foo",
            "bar",
            4.1,
            4.1,
            4.1
          ],
          [
            "2020-08-01 00:00:10",
            "v1",
            "foo",
            "bar",
            4.1,
            4.1,
            4.1
          ],
          [
            "2020-08-01 00:00:11",
            "v1",
            "foo",
            "bar",
            5.0,
            5.0,
            5.0
          ],
          [
            "2020-08-01 00:01:12",
            "v1",
            "foo",
            "bar",
            10.7,
            10.7,
            10.7
          ],
          [
            "2020-08-01 00:01:13",
            "v1",
            "foo",
            "bar",
            10.7,
            10.7,
            10.7
          ],
          [
            "2020-08-01 00:01:14",
            "v1",
            "foo",
            "bar",
            10.7,
            10.7,
            10.7
          ],
          [
            "2020-08-01 00:01:15",
            "v1",
            "foo",
            "bar",
            42.3,
            42.3,
            42.3
          ],
          [
            "2020-08-01 00:01:16",
            "v1",
            "foo",
            "bar",
            37.6,
            37.6,
            37.6
          ],
          [
            "2020-08-01 00:01:17",
            "v1",
            "foo",
            "bar",
            61.5,
            61.5,
            61.5
          ],
          [
            "2020-09-01 00:01:12",
            "v1",
            "foo",
            "bar",
            28.9,
            28.9,
            28.9
          ],
          [
            "2020-09-01 00:19:12",
            "v1",
            "foo",
            "bar",
            0.1,
            0.1,
            0.1
          ]
        ]
      },
      "expected": {
        "schema": "start_ts STRING NOT NULL, end_ts STRING NOT NULL,identifier_1 STRING NOT NULL,identifier_2 STRING NOT NULL,identifier_3 STRING NOT NULL",
        "other_ts_cols": [
          "start_ts",
          "end_ts"
        ],
        "data": [
          [
            "2020-08-01 00:00:09",
            "2020-08-01 00:00:10",
            "v1",
            "foo",
            "bar"
          ],
          [
            "2020-08-01 00:01:12",
            "2020-08-01 00:01:14",
            "v1",
            "foo",
            "bar"
          ]
        ]
      }
    },
    "test_eq_1": {
      "input": {
        "schema": "event_ts STRING NOT NULL, identifier_1 STRING NOT NULL, identifier_2 STRING NOT NULL, identifier_3 STRING NOT NULL, metric_1 FLOAT, metric_2 FLOAT, metric_3 FLOAT",
        "ts_col": "event_ts",
        "partition_cols": [
          "identifier_1",
          "identifier_2",
          "identifier_3"
        ],
        "data": [
          [
            "2020-08-01 00:00:09",
            "v1",
            "foo",
            "bar",
            4.1,
            null,
            4.1
          ],
          [
            "2020-08-01 00:00:10",
            "v1",
            "foo",
            "bar",
            4.1,
            null,
            4.1
          ],
          [
            "2020-08-01 00:00:11",
            "v1",
            "foo",
            "bar",
            5.0,
            5.0,
            5.0
          ],
          [
            "2020-08-01 00:01:12",
            "v1",
            "foo",
            "bar",
            10.7,
            10.7,
            10.7
          ],
          [
            "2020-08-01 00:01:13",
            "v1",
            "foo",
            "bar",
            10.7,
            10.7,
            10.7
          ],
          [
            "2020-08-01 00:01:14",
            "v1",
            "foo",
            "bar",
            10.7,
            10.7,
            null
          ],
          [
            "2020-08-01 00:01:15",
            "v1",
            "foo",
            "bar",
            42.3,
            42.3,
            42.3
          ],
          [
            "2020-08-01 00:01:16",
            "v1",
            "foo",
            "bar",
            37.6,
            37.6,
            37.6
          ],
          [
            "2020-08-01 00:01:17",
            "v1",
            "foo",
            "bar",
            61.5,
            61.5,
            61.5
          ],
          [
            "2020-09-01 00:01:12",
            "v1",
            "foo",
            "bar",
            28.9,
            28.9,
            28.9
          ],
          [
            "2020-09-01 00:19:12",
            "v1",
            "foo",
            "bar",
            0.1,
            0.1,
            0.1
          ]
        ]
      },
      "expected": {
        "schema": "start_ts STRING NOT NULL, end_ts STRING NOT NULL,identifier_1 STRING NOT NULL,identifier_2 STRING NOT NULL,identifier_3 STRING NOT NULL",
        "other_ts_cols": [
          "start_ts",
          "end_ts"
        ],
        "data": [
          [
            "2020-08-01 00:01:12",
            "2020-08-01 00:01:13",
            "v1",
            "foo",
            "bar"
          ]
        ]
      }
    },
    "test_ne_0": {
      "input": {
        "schema": "event_ts STRING NOT NULL, identifier_1 STRING NOT NULL, identifier_2 STRING NOT NULL, identifier_3 STRING NOT NULL, metric_1 FLOAT NOT NULL, metric_2 FLOAT NOT NULL, metric_3 FLOAT NOT NULL",
        "ts_col": "event_ts",
        "partition_cols": [
          "identifier_1",
          "identifier_2",
          "identifier_3"
        ],
        "data": [
          [
            "2020-08-01 00:00:09",
            "v1",
            "foo",
            "bar",
            4.1,
            4.1,
            4.1
          ],
          [
            "2020-08-01 00:00:10",
            "v1",
            "foo",
            "bar",
            4.1,
            4.1,
            4.1
          ],
          [
            "2020-08-01 00:00:11",
            "v1",
            "foo",
            "bar",
            5.0,
            5.0,
            5.0
          ],
          [
            "2020-08-01 00:01:12",
            "v1",
            "foo",
            "bar",
            10.7,
            10.7,
            10.7
          ],
          [
            "2020-08-01 00:01:13",
            "v1",
            "foo",
            "bar",
            10.7,
            10.7,
            10.7
          ],
          [
            "2020-08-01 00:01:14",
            "v1",
            "foo",
            "bar",
            10.7,
            10.7,
            10.7
          ],
          [
            "2020-08-01 00:01:15",
            "v1",
            "foo",
            "bar",
            42.3,
            42.3,
            42.3
          ],
          [
            "2020-08-01 00:01:16",
            "v1",
            "foo",
            "bar",
            37.6,
            37.6,
            37.6
          ],
          [
            "2020-08-01 00:01:17",
            "v1",
            "foo",
            "bar",
            61.5,
            61.5,
            61.5
          ],
          [
            "2020-09-01 00:01:12",
            "v1",
            "foo",
            "bar",
            28.9,
            28.9,
            28.9
          ],
          [
            "2020-09-01 00:19:12",
            "v1",
            "foo",
            "bar",
            0.1,
            0.1,
            0.1
          ]
        ]
      },
      "expected": {
        "schema": "start_ts STRING NOT NULL, end_ts STRING NOT NULL,identifier_1 STRING NOT NULL,identifier_2 STRING NOT NULL,identifier_3 STRING NOT NULL",
        "other_ts_cols": [
          "start_ts",
          "end_ts"
        ],
        "data": [
          [
            "2020-08-01 00:00:10",
            "2020-08-01 00:01:12",
            "v1",
            "foo",
            "bar"
          ],
          [
            "2020-08-01 00:01:14",
            "2020-09-01 00:19:12",
            "v1",
            "foo",
            "bar"
          ]
        ]
      }
    },
    "test_ne_1": {
      "input": {
        "schema": "event_ts STRING NOT NULL, identifier_1 STRING NOT NULL, identifier_2 STRING NOT NULL, identifier_3 STRING NOT NULL, metric_1 FLOAT NOT NULL, metric_2 FLOAT NOT NULL, metric_3 FLOAT NOT NULL",
        "ts_col": "event_ts",
        "partition_cols": [
          "identifier_1",
          "identifier_2",
          "identifier_3"
        ],
        "data": [
          [
            "2020-08-01 00:00:09",
            "v1",
            "foo",
            "bar",
            4.1,
            4.1,
            4.1
          ],
          [
            "2020-08-01 00:00:10",
            "v1",
            "foo",
            "bar",
            4.1,
            4.0,
            4.2
          ],
          [
            "2020-08-01 00:00:11",
            "v1",
            "foo",
            "bar",
            4.3,
            4.1,
            4.7
          ]
        ]
      },
      "expected": {
        "schema": "start_ts STRING NOT NULL, end_ts STRING NOT NULL,identifier_1 STRING NOT NULL,identifier_2 STRING NOT NULL,identifier_3 STRING NOT NULL",
        "other_ts_cols": [
          "start_ts",
          "end_ts"
        ],
        "data": [
          [
            "2020-08-01 00:00:10",
            "2020-08-01 00:00:11",
            "v1",
            "foo",
            "bar"
          ]
        ]
      }
    },
    "test_gt_0": {
      "input": {
        "schema": "event_ts STRING NOT NULL, identifier_1 STRING NOT NULL, identifier_2 STRING NOT NULL, identifier_3 STRING NOT NULL, metric_1 FLOAT NOT NULL, metric_2 FLOAT NOT NULL, metric_3 FLOAT NOT NULL",
        "ts_col": "event_ts",
        "partition_cols": [
          "identifier_1",
          "identifier_2",
          "identifier_3"
        ],
        "data": [
          [
            "2020-08-01 00:00:09",
            "v1",
            "foo",
            "bar",
            4.1,
            4.1,
            4.1
          ],
          [
            "2020-08-01 00:00:10",
            "v1",
            "foo",
            "bar",
            4.1,
            4.1,
            4.1
          ],
          [
            "2020-08-01 00:00:11",
            "v1",
            "foo",
            "bar",
            5.0,
            5.0,
            5.0
          ],
          [
            "2020-08-01 00:01:12",
            "v1",
            "foo",
            "bar",
            10.7,
            10.7,
            10.7
          ],
          [
            "2020-08-01 00:01:13",
            "v1",
            "foo",
            "bar",
            10.7,
            10.7,
            10.7
          ],
          [
            "2020-08-01 00:01:14",
            "v1",
            "foo",
            "bar",
            10.7,
            10.7,
            10.7
          ],
          [
            "2020-08-01 00:01:15",
            "v1",
            "foo",
            "bar",
            42.3,
            42.3,
            42.3
          ],
          [
            "2020-08-01 00:01:16",
            "v1",
            "foo",
            "bar",
            37.6,
            37.6,
            37.6
          ],
          [
            "2020-08-01 00:01:17",
            "v1",
            "foo",
            "bar",
            61.5,
            61.5,
            61.5
          ],
          [
            "2020-09-01 00:01:12",
            "v1",
            "foo",
            "bar",
            28.9,
            28.9,
            28.9
          ],
          [
            "2020-09-01 00:19:12",
            "v1",
            "foo",
            "bar",
            0.1,
            0.1,
            0.1
          ]
        ]
      },
      "expected": {
        "schema": "start_ts STRING NOT NULL, end_ts STRING NOT NULL,identifier_1 STRING NOT NULL,identifier_2 STRING NOT NULL,identifier_3 STRING NOT NULL",
        "other_ts_cols": [
          "start_ts",
          "end_ts"
        ],
        "data": [
          [
            "2020-08-01 00:00:10",
            "2020-08-01 00:01:12",
            "v1",
            "foo",
            "bar"
          ],
          [
            "2020-08-01 00:01:14",
            "2020-08-01 00:01:15",
            "v1",
            "foo",
            "bar"
          ],
          [
            "2020-08-01 00:01:16",
            "2020-08-01 00:01:17",
            "v1",
            "foo",
            "bar"
          ]
        ]
      }
    },
    "test_gt_1": {
      "input": {
        "schema": "event_ts STRING NOT NULL, identifier_1 STRING NOT NULL, identifier_2 STRING NOT NULL, identifier_3 STRING NOT NULL, metric_1 FLOAT NOT NULL, metric_2 FLOAT NOT NULL, metric_3 FLOAT NOT NULL",
        "ts_col": "event_ts",
        "partition_cols": [
          "identifier_1",
          "identifier_2",
          "identifier_3"
        ],
        "data": [
          [
            "2020-08-01 00:00:09",
            "v1",
            "foo",
            "bar",
            4.3,
            4.1,
            4.7
          ],
          [
            "2020-08-01 00:00:10",
            "v1",
            "foo",
            "bar",
            4.4,
            4.0,
            4.6
          ],
          [
            "2020-08-01 00:00:11",
            "v1",
            "foo",
            "bar",
            4.5,
            4.1,
            4.7
          ]
        ]
      },
      "expected": {
        "schema": "start_ts STRING NOT NULL, end_ts STRING NOT NULL,identifier_1 STRING NOT NULL,identifier_2 STRING NOT NULL,identifier_3 STRING NOT NULL",
        "other_ts_cols": [
          "start_ts",
          "end_ts"
        ],
        "data": [
          [
            "2020-08-01 00:00:10",
            "2020-08-01 00:00:11",
            "v1",
            "foo",
            "bar"
          ]
        ]
      }
    },
    "test_lt_0": {
      "input": {
        "schema": "event_ts STRING NOT NULL, identifier_1 STRING NOT NULL, identifier_2 STRING NOT NULL, identifier_3 STRING NOT NULL, metric_1 FLOAT NOT NULL, metric_2 FLOAT NOT NULL, metric_3 FLOAT NOT NULL",
        "ts_col": "event_ts",
        "partition_cols": [
          "identifier_1",
          "identifier_2",
          "identifier_3"
        ],
        "data": [
          [
            "2020-08-01 00:00:09",
            "v1",
            "foo",
            "bar",
            4.1,
            4.1,
            4.1
          ],
          [
            "2020-08-01 00:00:10",
            "v1",
            "foo",
            "bar",
            4.1,
            4.1,
            4.1
          ],
          [
            "2020-08-01 00:00:11",
            "v1",
            "foo",
            "bar",
            5.0,
            5.0,
            5.0
          ],
          [
            "2020-08-01 00:01:12",
            "v1",
            "foo",
            "bar",
            10.7,
            10.7,
            10.7
          ],
          [
            "2020-08-01 00:01:13",
            "v1",
            "foo",
            "bar",
            10.7,
            10.7,
            10.7
          ],
          [
            "2020-08-01 00:01:14",
            "v1",
            "foo",
            "bar",
            10.7,
            10.7,
            10.7
          ],
          [
            "2020-08-01 00:01:15",
            "v1",
            "foo",
            "bar",
            42.3,
            42.3,
            42.3
          ],
          [
            "2020-08-01 00:01:16",
            "v1",
            "foo",
            "bar",
            37.6,
            37.6,
            37.6
          ],
          [
            "2020-08-01 00:01:17",
            "v1",
            "foo",
            "bar",
            61.5,
            61.5,
            61.5
          ],
          [
            "2020-09-01 00:01:12",
            "v1",
            "foo",
            "bar",
            28.9,
            28.9,
            28.9
          ],
          [
            "2020-09-01 00:19:12",
            "v1",
            "foo",
            "bar",
            0.1,
            0.1,
            0.1
          ]
        ]
      },
      "expected": {
        "schema": "start_ts STRING NOT NULL, end_ts STRING NOT NULL,identifier_1 STRING NOT NULL,identifier_2 STRING NOT NULL,identifier_3 STRING NOT NULL",
        "other_ts_cols": [
          "start_ts",
          "end_ts"
        ],
        "data": [
          [
            "2020-08-01 00:01:15",
            "2020-08-01 00:01:16",
            "v1",
            "foo",
            "bar"
          ],
          [
            "2020-08-01 00:01:17",
            "2020-09-01 00:19:12",
            "v1",
            "foo",
            "bar"
          ]
        ]
      }
    },
    "test_lt_1": {
      "input": {
        "schema": "event_ts STRING NOT NULL, identifier_1 STRING NOT NULL, identifier_2 STRING NOT NULL, identifier_3 STRING NOT NULL, metric_1 FLOAT NOT NULL, metric_2 FLOAT NOT NULL, metric_3 FLOAT NOT NULL",
        "ts_col": "event_ts",
        "partition_cols": [
          "identifier_1",
          "identifier_2",
          "identifier_3"
        ],
        "data": [
          [
            "2020-08-01 00:00:09",
            "v1",
            "foo",
            "bar",
            4.3,
            4.1,
            4.7
          ],
          [
            "2020-08-01 00:00:10",
            "v1",
            "foo",
            "bar",
            4.2,
            4.2,
            4.8
          ],
          [
            "2020-08-01 00:00:11",
            "v1",
            "foo",
            "bar",
            4.1,
            4.1,
            4.7
          ]
        ]
      },
      "expected": {
        "schema": "start_ts STRING NOT NULL, end_ts STRING NOT NULL,identifier_1 STRING NOT NULL,identifier_2 STRING NOT NULL,identifier_3 STRING NOT NULL",
        "other_ts_cols": [
          "start_ts",
          "end_ts"
        ],
        "data": [
          [
            "2020-08-01 00:00:10",
            "2020-08-01 00:00:11",
            "v1",
            "foo",
            "bar"
          ]
        ]
      }
    },
    "test_gte_0": {
      "input": {
        "schema": "event_ts STRING NOT NULL, identifier_1 STRING NOT NULL, identifier_2 STRING NOT NULL, identifier_3 STRING NOT NULL, metric_1 FLOAT NOT NULL, metric_2 FLOAT NOT NULL, metric_3 FLOAT NOT NULL",
        "ts_col": "event_ts",
        "partition_cols": [
          "identifier_1",
          "identifier_2",
          "identifier_3"
        ],
        "data": [
          [
            "2020-08-01 00:00:09",
            "v1",
            "foo",
            "bar",
            4.1,
            4.1,
            4.1
          ],
          [
            "2020-08-01 00:00:10",
            "v1",
            "foo",
            "bar",
            4.1,
            4.1,
            4.1
          ],
          [
            "2020-08-01 00:00:11",
            "v1",
            "foo",
            "bar",
            5.0,
            5.0,
            5.0
          ],
          [
            "2020-08-01 00:01:12",
            "v1",
            "foo",
            "bar",
            10.7,
            10.7,
            10.7
          ],
          [
            "2020-08-01 00:01:13",
            "v1",
            "foo",
            "bar",
            10.7,
            10.7,
            10.7
          ],
          [
            "2020-08-01 00:01:14",
            "v1",
            "foo",
            "bar",
            10.7,
            10.7,
            10.7
          ],
          [
            "2020-08-01 00:01:15",
            "v1",
            "foo",
            "bar",
            42.3,
            42.3,
            42.3
          ],
          [
            "2020-08-01 00:01:16",
            "v1",
            "foo",
            "bar",
            37.6,
            37.6,
            37.6
          ],
          [
            "2020-08-01 00:01:17",
            "v1",
            "foo",
            "bar",
            61.5,
            61.5,
            61.5
          ],
          [
            "2020-09-01 00:01:12",
            "v1",
            "foo",
            "bar",
            28.9,
            28.9,
            28.9
          ],
          [
            "2020-09-01 00:19:12",
            "v1",
            "foo",
            "bar",
            0.1,
            0.1,
            0.1
          ]
        ]
      },
      "expected": {
        "schema": "start_ts STRING NOT NULL, end_ts STRING NOT NULL,identifier_1 STRING NOT NULL,identifier_2 STRING NOT NULL,identifier_3 STRING NOT NULL",
        "other_ts_cols": [
          "start_ts",
          "end_ts"
        ],
        "data": [
          [
            "2020-08-01 00:00:09",
            "2020-08-01 00:01:15",
            "v1",
            "foo",
            "bar"
          ],
          [
            "2020-08-01 00:01:16",
            "2020-08-01 00:01:17",
            "v1",
            "foo",
            "bar"
          ]
        ]
      }
    },
    "test_gte_1": {
      "input": {
        "schema": "event_ts STRING NOT NULL, identifier_1 STRING NOT NULL, identifier_2 STRING NOT NULL, identifier_3 STRING NOT NULL, metric_1 FLOAT NOT NULL, metric_2 FLOAT NOT NULL, metric_3 FLOAT NOT NULL",
        "ts_col": "event_ts",
        "partition_cols": [
          "identifier_1",
          "identifier_2",
          "identifier_3"
        ],
        "data": [
          [
            "2020-08-01 00:00:09",
            "v1",
            "foo",
            "bar",
            4.3,
            4.1,
            4.7
          ],
          [
            "2020-08-01 00:00:10",
            "v1",
            "foo",
            "bar",
            4.4,
            4.0,
            4.6
          ],
          [
            "2020-08-01 00:00:11",
            "v1",
            "foo",
            "bar",
            4.5,
            4.0,
            4.7
          ]
        ]
      },
      "expected": {
        "schema": "start_ts STRING NOT NULL, end_ts STRING NOT NULL,identifier_1 STRING NOT NULL,identifier_2 STRING NOT NULL,identifier_3 STRING NOT NULL",
        "other_ts_cols": [
          "start_ts",
          "end_ts"
        ],
        "data": [
          [
            "2020-08-01 00:00:10",
            "2020-08-01 00:00:11",
            "v1",
            "foo",
            "bar"
          ]
        ]
      }
    },
    "test_lte_0": {
      "input": {
        "schema": "event_ts STRING NOT NULL, identifier_1 STRING NOT NULL, identifier_2 STRING NOT NULL, identifier_3 STRING NOT NULL, metric_1 FLOAT NOT NULL, metric_2 FLOAT NOT NULL, metric_3 FLOAT NOT NULL",
        "ts_col": "event_ts",
        "partition_cols": [
          "identifier_1",
          "identifier_2",
          "identifier_3"
        ],
        "data": [
          [
            "2020-08-01 00:00:09",
            "v1",
            "foo",
            "bar",
            4.1,
            4.1,
            4.1
          ],
          [
            "2020-08-01 00:00:10",
            "v1",
            "foo",
            "bar",
            4.1,
            4.1,
            4.1
          ],
          [
            "2020-08-01 00:00:11",
            "v1",
            "foo",
            "bar",
            5.0,
            5.0,
            5.0
          ],
          [
            "2020-08-01 00:01:12",
            "v1",
            "foo",
            "bar",
            10.7,
            10.7,
            10.7
          ],
          [
            "2020-08-01 00:01:13",
            "v1",
            "foo",
            "bar",
            10.7,
            10.7,
            10.7
          ],
          [
            "2020-08-01 00:01:14",
            "v1",
            "foo",
            "bar",
            10.7,
            10.7,
            10.7
          ],
          [
            "2020-08-01 00:01:15",
            "v1",
            "foo",
            "bar",
            42.3,
            42.3,
            42.3
          ],
          [
            "2020-08-01 00:01:16",
            "v1",
            "foo",
            "bar",
            37.6,
            37.6,
            37.6
          ],
          [
            "2020-08-01 00:01:17",
            "v1",
            "foo",
            "bar",
            61.5,
            61.5,
            61.5
          ],
          [
            "2020-09-01 00:01:12",
            "v1",
            "foo",
            "bar",
            28.9,
            28.9,
            28.9
          ],
          [
            "2020-09-01 00:19:12",
            "v1",
            "foo",
            "bar",
            0.1,
            0.1,
            0.1
          ]
        ]
      },
      "expected": {
        "schema": "start_ts STRING NOT NULL, end_ts STRING NOT NULL,identifier_1 STRING NOT NULL,identifier_2 STRING NOT NULL,identifier_3 STRING NOT NULL",
        "other_ts_cols": [
          "start_ts",
          "end_ts"
        ],
        "data": [
          [
            "2020-08-01 00:00:09",
            "2020-08-01 00:00:10",
            "v1",
            "foo",
            "bar"
          ],
          [
            "2020-08-01 00:01:12",
            "2020-08-01 00:01:14",
            "v1",
            "foo",
            "bar"
          ],
          [
            "2020-08-01 00:01:15",
            "2020-08-01 00:01:16",
            "v1",
            "foo",
            "bar"
          ],
          [
            "2020-08-01 00:01:17",
            "2020-09-01 00:19:12",
            "v1",
            "foo",
            "bar"
          ]
        ]
      }
    },
    "test_lte_1": {
      "input": {
        "schema": "event_ts STRING NOT NULL, identifier_1 STRING NOT NULL, identifier_2 STRING NOT NULL, identifier_3 STRING NOT NULL, metric_1 FLOAT NOT NULL, metric_2 FLOAT NOT NULL, metric_3 FLOAT NOT NULL",
        "ts_col": "event_ts",
        "partition_cols": [
          "identifier_1",
          "identifier_2",
          "identifier_3"
        ],
        "data": [
          [
            "2020-08-01 00:00:09",
            "v1",
            "foo",
            "bar",
            4.3,
            4.1,
            4.7
          ],
          [
            "2020-08-01 00:00:10",
            "v1",
            "foo",
            "bar",
            4.2,
            4.2,
            4.8
          ],
          [
            "2020-08-01 00:00:11",
            "v1",
            "foo",
            "bar",
            4.1,
            4.2,
            4.7
          ]
        ]
      },
      "expected": {
        "schema": "start_ts STRING NOT NULL, end_ts STRING NOT NULL,identifier_1 STRING NOT NULL,identifier_2 STRING NOT NULL,identifier_3 STRING NOT NULL",
        "other_ts_cols": [
          "start_ts",
          "end_ts"
        ],
        "data": [
          [
            "2020-08-01 00:00:10",
            "2020-08-01 00:00:11",
            "v1",
            "foo",
            "bar"
          ]
        ]
      }
    },
    "test_threshold_fn": {
      "input": {
        "schema": "event_ts STRING NOT NULL, identifier_1 STRING NOT NULL, identifier_2 STRING NOT NULL, identifier_3 STRING NOT NULL, metric_1 FLOAT NOT NULL, metric_2 FLOAT NOT NULL, metric_3 FLOAT NOT NULL",
        "ts_col": "event_ts",
        "partition_cols": [
          "identifier_1",
          "identifier_2",
          "identifier_3"
        ],
        "data": [
          [
            "2020-08-01 00:00:09",
            "v1",
            "foo",
            "bar",
            4.1,
            4.1,
            4.1
          ],
          [
            "2020-08-01 00:00:10",
            "v1",
            "foo",
            "bar",
            4.1,
            4.1,
            4.1
          ],
          [
            "2020-08-01 00:00:11",
            "v1",
            "foo",
            "bar",
            5.0,
            5.0,
            5.0
          ],
          [
            "2020-08-01 00:01:12",
            "v1",
            "foo",
            "bar",
            10.7,
            10.7,
            10.7
          ],
          [
            "2020-08-01 00:01:13",
            "v1",
            "foo",
            "bar",
            10.7,
            10.7,
            10.7
          ],
          [
            "2020-08-01 00:01:14",
            "v1",
            "foo",
            "bar",
            10.7,
            10.7,
            10.7
          ],
          [
            "2020-08-01 00:01:15",
            "v1",
            "foo",
            "bar",
            42.3,
            42.3,
            42.3
          ],
          [
            "2020-08-01 00:01:16",
            "v1",
            "foo",
            "bar",
            37.6,
            37.6,
            37.6
          ],
          [
            "2020-08-01 00:01:17",
            "v1",
            "foo",
            "bar",
            61.5,
            61.5,
            61.5
          ],
          [
            "2020-09-01 00:01:12",
            "v1",
            "foo",
            "bar",
            28.9,
            28.9,
            28.9
          ],
          [
            "2020-09-01 00:19:12",
            "v1",
            "foo",
            "bar",
            0.1,
            0.1,
            0.1
          ]
        ]
      },
      "expected": {
        "schema": "start_ts: STRING, end_ts: STRING, identifier_1 STRING NOT NULL, identifier_2 STRING NOT NULL ,identifier_3 STRING NOT NULL",
        "other_ts_cols": [
          "start_ts",
          "end_ts"
        ],
        "data": [
          [
            "2020-08-01 00:00:09",
            "2020-08-01 00:00:10",
            "v1",
            "foo",
            "bar"
          ],
          [
            "2020-08-01 00:01:12",
            "2020-08-01 00:01:14",
            "v1",
            "foo",
            "bar"
          ]
        ]
      }
    },
    "test_null_safe_eq_0": {
      "input": {
        "schema": "event_ts STRING NOT NULL, identifier_1 STRING NOT NULL, identifier_2 STRING NOT NULL, identifier_3 STRING NOT NULL, metric_1 FLOAT, metric_2 FLOAT, metric_3 FLOAT",
        "ts_col": "event_ts",
        "partition_cols": [
          "identifier_1",
          "identifier_2",
          "identifier_3"
        ],
        "data": [
          [
            "2020-08-01 00:00:09",
            "v1",
            "foo",
            "bar",
            4.1,
            null,
            4.1
          ],
          [
            "2020-08-01 00:00:10",
            "v1",
            "foo",
            "bar",
            4.1,
            null,
            4.1
          ],
          [
            "2020-08-01 00:00:11",
            "v1",
            "foo",
            "bar",
            5.0,
            5.0,
            5.0
          ],
          [
            "2020-08-01 00:01:12",
            "v1",
            "foo",
            "bar",
            null,
            10.7,
            10.7
          ],
          [
            "2020-08-01 00:01:13",
            "v1",
            "foo",
            "bar",
            null,
            10.7,
            10.7
          ],
          [
            "2020-08-01 00:01:14",
            "v1",
            "foo",
            "bar",
            null,
            10.7,
            10.7
          ],
          [
            "2020-08-01 00:01:15",
            "v1",
            "foo",
            "bar",
            42.3,
            42.3,
            42.3
          ],
          [
            "2020-08-01 00:01:16",
            "v1",
            "foo",
            "bar",
            37.6,
            37.6,
            37.6
          ],
          [
            "2020-08-01 00:01:17",
            "v1",
            "foo",
            "bar",
            61.5,
            61.5,
            61.5
          ],
          [
            "2020-09-01 00:01:12",
            "v1",
            "foo",
            "bar",
            28.9,
            28.9,
            28.9
          ],
          [
            "2020-09-01 00:19:12",
            "v1",
            "foo",
            "bar",
            0.1,
            0.1,
            0.1
          ]
        ]
      },
      "expected": {
        "schema": "start_ts STRING NOT NULL, end_ts STRING NOT NULL,identifier_1 STRING NOT NULL,identifier_2 STRING NOT NULL,identifier_3 STRING NOT NULL",
        "other_ts_cols": [
          "start_ts",
          "end_ts"
        ],
        "data": [
          [
            "2020-08-01 00:00:09",
            "2020-08-01 00:00:10",
            "v1",
            "foo",
            "bar"
          ],
          [
            "2020-08-01 00:01:12",
            "2020-08-01 00:01:14",
            "v1",
            "foo",
            "bar"
          ]
        ]
      }
    },
    "test_null_safe_eq_1": {
      "input": {
        "schema": "event_ts STRING NOT NULL, identifier_1 STRING NOT NULL, identifier_2 STRING NOT NULL, identifier_3 STRING NOT NULL, metric_1 FLOAT, metric_2 FLOAT, metric_3 FLOAT",
        "ts_col": "event_ts",
        "partition_cols": [
          "identifier_1",
          "identifier_2",
          "identifier_3"
        ],
        "data": [
          [
            "2020-08-01 00:00:09",
            "v1",
            "foo",
            "bar",
            4.1,
            null,
            4.1
          ],
          [
            "2020-08-01 00:00:10",
            "v1",
            "foo",
            "bar",
            4.1,
            4.1,
            null
          ],
          [
            "2020-08-01 00:00:11",
            "v1",
            "foo",
            "bar",
            5.0,
            5.0,
            5.0
          ],
          [
            "2020-08-01 00:01:12",
            "v1",
            "foo",
            "bar",
            null,
            10.7,
            10.7
          ],
          [
            "2020-08-01 00:01:13",
            "v1",
            "foo",
            "bar",
            null,
            10.7,
            10.7
          ],
          [
            "2020-08-01 00:01:14",
            "v1",
            "foo",
            "bar",
            10.7,
            null,
            10.7
          ],
          [
            "2020-08-01 00:01:15",
            "v1",
            "foo",
            "bar",
            42.3,
            42.3,
            42.3
          ],
          [
            "2020-08-01 00:01:16",
            "v1",
            "foo",
            "bar",
            37.6,
            37.6,
            37.6
          ],
          [
            "2020-08-01 00:01:17",
            "v1",
            "foo",
            "bar",
            61.5,
            61.5,
            61.5
          ],
          [
            "2020-09-01 00:01:12",
            "v1",
            "foo",
            "bar",
            28.9,
            28.9,
            28.9
          ],
          [
            "2020-09-01 00:19:12",
            "v1",
            "foo",
            "bar",
            0.1,
            0.1,
            0.1
          ]
        ]
      },
      "expected": {
        "schema": "start_ts STRING NOT NULL, end_ts STRING NOT NULL,identifier_1 STRING NOT NULL,identifier_2 STRING NOT NULL,identifier_3 STRING NOT NULL",
        "other_ts_cols": [
          "start_ts",
          "end_ts"
        ],
        "data": [
          [
            "2020-08-01 00:01:12",
            "2020-08-01 00:01:13",
            "v1",
            "foo",
            "bar"
          ]
        ]
      }
    },
    "test_adjacent_intervals": {
      "input": {
        "schema": "event_ts STRING NOT NULL, identifier_1 STRING NOT NULL, identifier_2 STRING NOT NULL, identifier_3 STRING NOT NULL, metric_1 FLOAT, metric_2 FLOAT, metric_3 FLOAT",
        "ts_col": "event_ts",
        "partition_cols": [
          "identifier_1",
          "identifier_2",
          "identifier_3"
        ],
        "data": [
          [
            "2020-08-01 00:00:09",
            "v1",
            "foo",
            "bar",
            4.1,
            4.1,
            4.1
          ],
          [
            "2020-08-01 00:00:10",
            "v1",
            "foo",
            "bar",
            4.1,
            4.1,
            4.1
          ],
          [
            "2020-08-01 00:00:11",
            "v1",
            "foo",
            "bar",
            5.0,
            5.0,
            5.0
          ],
          [
            "2020-08-01 00:00:12",
            "v1",
            "foo",
            "bar",
            5.0,
            5.0,
            5.0
          ],
          [
            "2020-08-01 00:01:12",
            "v1",
            "foo",
            "bar",
            10.7,
            10.7,
            10.7
          ],
          [
            "2020-08-01 00:01:13",
            "v1",
            "foo",
            "bar",
            10.7,
            10.7,
            10.7
          ],
          [
            "2020-08-01 00:01:14",
            "v1",
            "foo",
            "bar",
            10.7,
            10.7,
            10.7
          ]
        ]
      },
      "expected": {
        "schema": "start_ts STRING NOT NULL, end_ts STRING NOT NULL,identifier_1 STRING NOT NULL,identifier_2 STRING NOT NULL,identifier_3 STRING NOT NULL",
        "other_ts_cols": [
          "start_ts",
          "end_ts"
        ],
        "data": [
          [
            "2020-08-01 00:00:09",
            "2020-08-01 00:00:10",
            "v1",
            "foo",
            "bar"
          ],
          [
            "2020-08-01 00:00:11",
            "2020-08-01 00:00:12",
            "v1",
            "foo",
            "bar"
          ],
          [
            "2020-08-01 00:01:12",
            "2020-08-01 00:01:14",
            "v1",
            "foo",
            "bar"
          ]
        ]
      }
    },
    "test_invalid_state_definition_str": {
      "input": {
        "schema": "event_ts STRING NOT NULL, identifier_1 STRING NOT NULL, identifier_2 STRING NOT NULL, identifier_3 STRING NOT NULL, metric_1 FLOAT NOT NULL, metric_2 FLOAT NOT NULL, metric_3 FLOAT NOT NULL",
        "ts_col": "event_ts",
        "partition_cols": [
          "identifier_1",
          "identifier_2",
          "identifier_3"
        ],
        "data": [
          [
            "2020-08-01 00:00:09",
            "v1",
            "foo",
            "bar",
            4.1,
            4.1,
            4.1
          ]
        ]
      }
    },
    "test_invalid_state_definition_type": {
      "input": {
        "schema": "event_ts STRING NOT NULL, identifier_1 STRING NOT NULL, identifier_2 STRING NOT NULL, identifier_3 STRING NOT NULL, metric_1 FLOAT NOT NULL, metric_2 FLOAT NOT NULL, metric_3 FLOAT NOT NULL",
        "ts_col": "event_ts",
        "partition_cols": [
          "identifier_1",
          "identifier_2",
          "identifier_3"
        ],
        "data": [
          [
            "2020-08-01 00:00:09",
            "v1",
            "foo",
            "bar",
            4.1,
            4.1,
            4.1
          ]
        ]
      }
    }
  }
}