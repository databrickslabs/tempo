{
  "__SharedData": {
    "temp_slice_init_data": {
      "schema": "symbol string, event_ts string, trade_pr float",
      "ts_col": "event_ts",
      "series_ids": ["symbol"],
      "data": [
        ["S1", "2020-08-01 00:00:10", 349.21],
        ["S1", "2020-08-01 00:01:12", 351.32],
        ["S1", "2020-09-01 00:02:10", 361.1],
        ["S1", "2020-09-01 00:19:12", 362.1],
        ["S2", "2020-08-01 00:01:10", 743.01],
        ["S2", "2020-08-01 00:01:24", 751.92],
        ["S2", "2020-09-01 00:02:10", 761.10],
        ["S2", "2020-09-01 00:20:42", 762.33]
      ]
    }
  },
  "TSDFBaseTests": {
    "test_TSDF_init": {
      "init": {
        "$ref": "#/__SharedData/temp_slice_init_data"
      }
    },
    "test__add_double_ts": {
      "init": {
        "$ref": "#/__SharedData/temp_slice_init_data"
      }
    },
    "test__validated_column_not_string": {
      "init": {
        "$ref": "#/__SharedData/temp_slice_init_data"
      }
    },
    "test__validated_column_not_found": {
      "init": {
        "$ref": "#/__SharedData/temp_slice_init_data"
      }
    },
    "test__validated_column": {
      "init": {
        "$ref": "#/__SharedData/temp_slice_init_data"
      }
    },
    "test__validated_columns_string": {
      "init": {
        "$ref": "#/__SharedData/temp_slice_init_data"
      }
    },
    "test__validated_columns_none": {
      "init": {
        "$ref": "#/__SharedData/temp_slice_init_data"
      }
    },
    "test__validated_columns_tuple": {
      "init": {
        "$ref": "#/__SharedData/temp_slice_init_data"
      }
    },
    "test__validated_columns_list_multiple_elems": {
      "init": {
        "$ref": "#/__SharedData/temp_slice_init_data"
      }
    },
    "test__checkPartitionCols": {
      "init": {
        "$ref": "#/__SharedData/temp_slice_init_data"
      },
      "right_tsdf": {
        "schema": "symbol string, event_ts string, trade_pr float",
        "ts_col": "event_ts",
        "series_ids": [
          "event_ts"
        ],
        "data": [
          [
            "S1",
            "2020-08-01 00:00:10",
            349.21
          ]
        ]
      }
    },
    "test__validateTsColMatch": {
      "init": {
        "$ref": "#/__SharedData/temp_slice_init_data"
      },
      "right_tsdf": {
        "schema": "symbol string, event_ts int, trade_pr float",
        "ts_col": "event_ts",
        "series_ids": [
          "symbol"
        ],
        "data": [
          [
            "S1",
            1596240010,
            349.21
          ]
        ]
      }
    },
    "test__addPrefixToColumns_non_empty_string": {
      "init": {
        "$ref": "#/__SharedData/temp_slice_init_data"
      }
    },
    "test__addPrefixToColumns_empty_string": {
      "init": {
        "$ref": "#/__SharedData/temp_slice_init_data"
      }
    },
    "test__addColumnsFromOtherDF": {
      "init": {
        "$ref": "#/__SharedData/temp_slice_init_data"
      }
    },
    "test__combineTSDF": {
      "init": {
        "$ref": "#/__SharedData/temp_slice_init_data"
      }
    },
    "test__getLastRightRow": {
      "init": {
        "$ref": "#/__SharedData/temp_slice_init_data"
      }
    },
    "test__getTimePartitions": {
      "init": {
        "$ref": "#/__SharedData/temp_slice_init_data"
      },
      "expected": {
        "schema": "symbol string, event_ts string, trade_pr float, ts_partition int, is_original int",
        "ts_col": "event_ts",
        "series_ids": [
          "symbol"
        ],
        "data": [
          [
            "S1",
            "2020-08-01 00:00:10",
            349.21,
            1596240010,
            1
          ],
          [
            "S1",
            "2020-08-01 00:01:12",
            351.32,
            1596240070,
            1
          ],
          [
            "S1",
            "2020-09-01 00:02:10",
            361.1,
            1598918530,
            1
          ],
          [
            "S1",
            "2020-09-01 00:19:12",
            362.1,
            1598919550,
            1
          ],
          [
            "S2",
            "2020-08-01 00:01:10",
            743.01,
            1596240070,
            1
          ],
          [
            "S2",
            "2020-08-01 00:01:24",
            751.92,
            1596240080,
            1
          ],
          [
            "S2",
            "2020-09-01 00:02:10",
            761.1,
            1598918530,
            1
          ],
          [
            "S2",
            "2020-09-01 00:20:42",
            762.33,
            1598919640,
            1
          ]
        ]
      }
    },
    "test__getTimePartitions_with_fraction": {
      "init": {
        "$ref": "#/__SharedData/temp_slice_init_data"
      },
      "expected": {
        "schema": "symbol string, event_ts string, trade_pr float, ts_partition int, is_original int",
        "ts_col": "event_ts",
        "series_ids": [
          "symbol"
        ],
        "data": [
          [
            "S1",
            "2020-08-01 00:00:10",
            349.21,
            1596240010,
            1
          ],
          [
            "S1",
            "2020-08-01 00:01:12",
            351.32,
            1596240070,
            1
          ],
          [
            "S1",
            "2020-09-01 00:02:10",
            361.1,
            1598918530,
            1
          ],
          [
            "S1",
            "2020-09-01 00:19:12",
            362.1,
            1598919550,
            1
          ],
          [
            "S2",
            "2020-08-01 00:01:10",
            743.01,
            1596240070,
            1
          ],
          [
            "S2",
            "2020-08-01 00:01:24",
            751.92,
            1596240080,
            1
          ],
          [
            "S2",
            "2020-09-01 00:02:10",
            761.1,
            1598918530,
            1
          ],
          [
            "S2",
            "2020-09-01 00:20:42",
            762.33,
            1598919640,
            1
          ]
        ]
      }
    },
    "test_select_empty": {
      "init": {
        "$ref": "#/__SharedData/temp_slice_init_data"
      }
    },
    "test_select_only_required_cols": {
      "init": {
        "$ref": "#/__SharedData/temp_slice_init_data"
      }
    },
    "test_select_all_cols": {
      "init": {
        "$ref": "#/__SharedData/temp_slice_init_data"
      }
    },
    "test_show": {
      "init": {
        "$ref": "#/__SharedData/temp_slice_init_data"
      }
    },
    "test_show_n_5": {
      "init": {
        "$ref": "#/__SharedData/temp_slice_init_data"
      }
    },
    "test_show_k_gt_n": {
      "init": {
        "$ref": "#/__SharedData/temp_slice_init_data"
      }
    },
    "test_show_truncate_false": {
      "init": {
        "$ref": "#/__SharedData/temp_slice_init_data"
      }
    },
    "test_show_vertical_true": {
      "init": {
        "$ref": "#/__SharedData/temp_slice_init_data"
      }
    },
    "test_show_vertical_true_n_5": {
      "init": {
        "$ref": "#/__SharedData/temp_slice_init_data"
      }
    },
    "test_show_truncate_false_vertical_true": {
      "init": {
        "$ref": "#/__SharedData/temp_slice_init_data"
      }
    },
    "test_describe": {
      "init": {
        "schema": "symbol string, event_ts string, trade_pr float",
        "ts_col": "event_ts",
        "series_ids": [
          "symbol"
        ],
        "data": [
          [
            "S1",
            "2020-08-01 00:00:10",
            349.21
          ],
          [
            "S1",
            "2020-08-01 00:01:12",
            351.32
          ],
          [
            "S1",
            "2020-09-01 00:02:10",
            361.1
          ],
          [
            "S1",
            "2020-09-01 00:19:12",
            362.1
          ]
        ]
      }
    },
    "test__getSparkPlan": {
      "init": {
        "$ref": "#/TSDFBaseTests/test__getBytesFromPlan/init"
      }
    },
    "test__getBytesFromPlan": {
      "init": {
        "schema": "symbol string, event_ts string, trade_pr float",
        "ts_col": "event_ts",
        "series_ids": [
          "symbol"
        ],
        "data": [
          [
            "S1",
            "2020-08-01 00:00:10",
            349.21
          ],
          [
            "S1",
            "2020-08-01 00:01:12",
            351.32
          ],
          [
            "S1",
            "2020-09-01 00:02:10",
            361.1
          ],
          [
            "S1",
            "2020-09-01 00:19:12",
            362.1
          ]
        ]
      }
    },
    "test__getBytesFromPlan_search_result_is_None": {
      "init": {
        "$ref": "#/TSDFBaseTests/test__getBytesFromPlan/init"
      }
    },
    "test__getBytesFromPlan_size_in_GiB": {
      "init": {
        "$ref": "#/TSDFBaseTests/test__getBytesFromPlan/init"
      }
    },
    "test__getBytesFromPlan_size_in_MiB": {
      "init": {
        "$ref": "#/TSDFBaseTests/test__getBytesFromPlan/init"
      }
    },
    "test__getBytesFromPlan_size_in_KiB": {
      "init": {
        "$ref": "#/TSDFBaseTests/test__getBytesFromPlan/init"
      }
    },
    "test_at_string_timestamp": {
      "init": {
        "$ref": "#/__SharedData/temp_slice_init_data"
      },
      "expected": {
        "schema": "symbol string, event_ts string, trade_pr float",
        "ts_col": "event_ts",
        "series_ids": [
          "symbol"
        ],
        "data": [
          [
            "S1",
            "2020-09-01 00:02:10",
            361.1
          ],
          [
            "S2",
            "2020-09-01 00:02:10",
            761.10
          ]
        ]
      }
    },
    "test_at_numeric_timestamp": {
      "init": {
        "$ref": "#/__SharedData/temp_slice_init_data"
      },
      "expected": {
        "$ref": "#/TSDFBaseTests/test_at_string_timestamp/expected"
      }
    },
    "test_before_string_timestamp": {
      "init": {
        "$ref": "#/__SharedData/temp_slice_init_data"
      },
      "expected": {
        "schema": "symbol string, event_ts string, trade_pr float",
        "ts_col": "event_ts",
        "series_ids": [
          "symbol"
        ],
        "data": [
          [
            "S1",
            "2020-08-01 00:00:10",
            349.21
          ],
          [
            "S1",
            "2020-08-01 00:01:12",
            351.32
          ],
          [
            "S2",
            "2020-08-01 00:01:10",
            743.01
          ],
          [
            "S2",
            "2020-08-01 00:01:24",
            751.92
          ]
        ]
      }
    },
    "test_before_numeric_timestamp": {
      "init": {
        "$ref": "#/__SharedData/temp_slice_init_data"
      },
      "expected": {
        "$ref": "#/TSDFBaseTests/test_before_string_timestamp/expected"
      }
    },
    "test_atOrBefore_string_timestamp": {
      "init": {
        "$ref": "#/__SharedData/temp_slice_init_data"
      },
      "expected": {
        "schema": "symbol string, event_ts string, trade_pr float",
        "ts_col": "event_ts",
        "series_ids": [
          "symbol"
        ],
        "data": [
          [
            "S1",
            "2020-08-01 00:00:10",
            349.21
          ],
          [
            "S1",
            "2020-08-01 00:01:12",
            351.32
          ],
          [
            "S1",
            "2020-09-01 00:02:10",
            361.1
          ],
          [
            "S2",
            "2020-08-01 00:01:10",
            743.01
          ],
          [
            "S2",
            "2020-08-01 00:01:24",
            751.92
          ],
          [
            "S2",
            "2020-09-01 00:02:10",
            761.10
          ]
        ]
      }
    },
    "test_atOrBefore_numeric_timestamp": {
      "init": {
        "$ref": "#/__SharedData/temp_slice_init_data"
      },
      "expected": {
        "$ref": "#/TSDFBaseTests/test_atOrBefore_string_timestamp/expected"
      }
    },
    "test_after_string_timestamp": {
      "init": {
        "$ref": "#/__SharedData/temp_slice_init_data"
      },
      "expected": {
        "schema": "symbol string, event_ts string, trade_pr float",
        "ts_col": "event_ts",
        "series_ids": [
          "symbol"
        ],
        "data": [
          [
            "S1",
            "2020-09-01 00:19:12",
            362.1
          ],
          [
            "S2",
            "2020-09-01 00:20:42",
            762.33
          ]
        ]
      }
    },
    "test_after_numeric_timestamp": {
      "init": {
        "$ref": "#/__SharedData/temp_slice_init_data"
      },
      "expected": {
        "$ref": "#/TSDFBaseTests/test_after_string_timestamp/expected"
      }
    },
    "test_atOrAfter_string_timestamp": {
      "init": {
        "$ref": "#/__SharedData/temp_slice_init_data"
      },
      "expected": {
        "schema": "symbol string, event_ts string, trade_pr float",
        "ts_col": "event_ts",
        "series_ids": [
          "symbol"
        ],
        "data": [
          [
            "S1",
            "2020-09-01 00:02:10",
            361.1
          ],
          [
            "S1",
            "2020-09-01 00:19:12",
            362.1
          ],
          [
            "S2",
            "2020-09-01 00:02:10",
            761.10
          ],
          [
            "S2",
            "2020-09-01 00:20:42",
            762.33
          ]
        ]
      }
    },
    "test_atOrAfter_numeric_timestamp": {
      "init": {
        "$ref": "#/__SharedData/temp_slice_init_data"
      },
      "expected": {
        "$ref": "#/TSDFBaseTests/test_atOrAfter_string_timestamp/expected"
      }
    },
    "test_between_string_timestamp": {
      "init": {
        "$ref": "#/__SharedData/temp_slice_init_data"
      },
      "expected": {
        "schema": "symbol string, event_ts string, trade_pr float",
        "ts_col": "event_ts",
        "series_ids": [
          "symbol"
        ],
        "data": [
          [
            "S1",
            "2020-08-01 00:01:12",
            351.32
          ],
          [
            "S1",
            "2020-09-01 00:02:10",
            361.1
          ],
          [
            "S2",
            "2020-08-01 00:01:10",
            743.01
          ],
          [
            "S2",
            "2020-08-01 00:01:24",
            751.92
          ],
          [
            "S2",
            "2020-09-01 00:02:10",
            761.10
          ]
        ]
      }
    },
    "test_between_numeric_timestamp": {
      "init": {
        "$ref": "#/__SharedData/temp_slice_init_data"
      },
      "expected": {
        "$ref": "#/TSDFBaseTests/test_between_string_timestamp/expected"
      }
    },
    "test_between_exclusive_string_timestamp": {
      "init": {
        "$ref": "#/__SharedData/temp_slice_init_data"
      },
      "expected": {
        "schema": "symbol string, event_ts string, trade_pr float",
        "ts_col": "event_ts",
        "series_ids": [
          "symbol"
        ],
        "data": [
          [
            "S1",
            "2020-08-01 00:01:12",
            351.32
          ],
          [
            "S1",
            "2020-09-01 00:02:10",
            361.1
          ],
          [
            "S2",
            "2020-08-01 00:01:24",
            751.92
          ],
          [
            "S2",
            "2020-09-01 00:02:10",
            761.10
          ]
        ]
      }
    },
    "test_between_exclusive_numeric_timestamp": {
      "init": {
        "$ref": "#/__SharedData/temp_slice_init_data"
      },
      "expected": {
        "$ref": "#/TSDFBaseTests/test_between_exclusive_string_timestamp/expected"
      }
    },
    "test_earliest_string_timestamp": {
      "init": {
        "$ref": "#/__SharedData/temp_slice_init_data"
      },
      "expected": {
        "schema": "symbol string, event_ts string, trade_pr float",
        "ts_col": "event_ts",
        "series_ids": [
          "symbol"
        ],
        "data": [
          [
            "S1",
            "2020-08-01 00:00:10",
            349.21
          ],
          [
            "S1",
            "2020-08-01 00:01:12",
            351.32
          ],
          [
            "S1",
            "2020-09-01 00:02:10",
            361.1
          ],
          [
            "S2",
            "2020-08-01 00:01:10",
            743.01
          ],
          [
            "S2",
            "2020-08-01 00:01:24",
            751.92
          ],
          [
            "S2",
            "2020-09-01 00:02:10",
            761.10
          ]
        ]
      }
    },
    "test_earliest_numeric_timestamp": {
      "init": {
        "$ref": "#/__SharedData/temp_slice_init_data"
      },
      "expected": {
        "$ref": "#/TSDFBaseTests/test_earliest_string_timestamp/expected"
      }
    },
    "test_latest_string_timestamp": {
      "init": {
        "$ref": "#/__SharedData/temp_slice_init_data"
      },
      "expected": {
        "schema": "symbol string, event_ts string, trade_pr float",
        "ts_col": "event_ts",
        "series_ids": [
          "symbol"
        ],
        "data": [
          [
            "S1",
            "2020-08-01 00:01:12",
            351.32
          ],
          [
            "S1",
            "2020-09-01 00:02:10",
            361.1
          ],
          [
            "S1",
            "2020-09-01 00:19:12",
            362.1
          ],
          [
            "S2",
            "2020-08-01 00:01:24",
            751.92
          ],
          [
            "S2",
            "2020-09-01 00:02:10",
            761.10
          ],
          [
            "S2",
            "2020-09-01 00:20:42",
            762.33
          ]
        ]
      }
    },
    "test_latest_numeric_timestamp": {
      "init": {
        "$ref": "#/__SharedData/temp_slice_init_data"
      },
      "expected": {
        "$ref": "#/TSDFBaseTests/test_latest_string_timestamp/expected"
      }
    },
    "test_priorTo_string_timestamp": {
      "init": {
        "$ref": "#/__SharedData/temp_slice_init_data"
      },
      "expected": {
        "schema": "symbol string, event_ts string, trade_pr float",
        "ts_col": "event_ts",
        "series_ids": [
          "symbol"
        ],
        "data": [
          [
            "S1",
            "2020-08-01 00:01:12",
            351.32
          ],
          [
            "S2",
            "2020-08-01 00:01:24",
            751.92
          ]
        ]
      }
    },
    "test_priorTo_numeric_timestamp": {
      "init": {
        "$ref": "#/__SharedData/temp_slice_init_data"
      },
      "expected": {
        "$ref": "#/TSDFBaseTests/test_priorTo_string_timestamp/expected"
      }
    },
    "test_subsequentTo_string_timestamp": {
      "init": {
        "$ref": "#/__SharedData/temp_slice_init_data"
      },
      "expected": {
        "schema": "symbol string, event_ts string, trade_pr float",
        "ts_col": "event_ts",
        "series_ids": [
          "symbol"
        ],
        "data": [
          [
            "S1",
            "2020-09-01 00:02:10",
            361.1
          ],
          [
            "S2",
            "2020-09-01 00:02:10",
            761.10
          ]
        ]
      }
    },
    "test_subsequentTo_numeric_timestamp": {
      "init": {
        "$ref": "#/__SharedData/temp_slice_init_data"
      },
      "expected": {
        "$ref": "#/TSDFBaseTests/test_subsequentTo_string_timestamp/expected"
      }
    },
    "test__rowsBetweenWindow": {
      "init": {
        "$ref": "#/__SharedData/temp_slice_init_data"
      }
    },
    "test_withPartitionCols": {
      "init": {
        "schema": "symbol string, event_ts string, trade_pr float",
        "ts_col": "event_ts",
        "data": {
          "$ref": "#/__SharedData/temp_slice_init_data/data"
        }
      }
    }
  },
  "ResampleTest": {
    "test_resample": {
      "input": {
        "schema": "symbol string, date string, event_ts string, trade_pr float, trade_pr_2 float",
        "ts_col": "event_ts",
        "series_ids": [
          "symbol"
        ],
        "data": [
          [
            "S1",
            "SAME_DT",
            "2020-08-01 00:00:10",
            349.21,
            10.0
          ],
          [
            "S1",
            "SAME_DT",
            "2020-08-01 00:00:11",
            340.21,
            9.0
          ],
          [
            "S1",
            "SAME_DT",
            "2020-08-01 00:01:12",
            353.32,
            8.0
          ],
          [
            "S1",
            "SAME_DT",
            "2020-08-01 00:01:13",
            351.32,
            7.0
          ],
          [
            "S1",
            "SAME_DT",
            "2020-08-01 00:01:14",
            350.32,
            6.0
          ],
          [
            "S1",
            "SAME_DT",
            "2020-09-01 00:01:12",
            361.1,
            5.0
          ],
          [
            "S1",
            "SAME_DT",
            "2020-09-01 00:19:12",
            362.1,
            4.0
          ]
        ]
      },
      "expected": {
        "schema": "symbol string, event_ts string, floor_trade_pr float, floor_date string, floor_trade_pr_2 float",
        "ts_col": "event_ts",
        "series_ids": [
          "symbol"
        ],
        "data": [
          [
            "S1",
            "2020-08-01 00:00:00",
            349.21,
            "SAME_DT",
            10.0
          ],
          [
            "S1",
            "2020-08-01 00:01:00",
            353.32,
            "SAME_DT",
            8.0
          ],
          [
            "S1",
            "2020-09-01 00:01:00",
            361.1,
            "SAME_DT",
            5.0
          ],
          [
            "S1",
            "2020-09-01 00:19:00",
            362.1,
            "SAME_DT",
            4.0
          ]
        ]
      },
      "expected30m": {
        "schema": "symbol string, event_ts string, date double, trade_pr double, trade_pr_2 double",
        "ts_col": "event_ts",
        "series_ids": [
          "symbol"
        ],
        "data": [
          [
            "S1",
            "2020-08-01 00:00:00",
            null,
            348.88,
            8.0
          ],
          [
            "S1",
            "2020-09-01 00:00:00",
            null,
            361.1,
            5.0
          ],
          [
            "S1",
            "2020-09-01 00:15:00",
            null,
            362.1,
            4.0
          ]
        ]
      },
      "expectedbars": {
        "schema": "symbol string, event_ts string, close_trade_pr float, close_trade_pr_2 float, high_trade_pr float, high_trade_pr_2 float, low_trade_pr float, low_trade_pr_2 float, open_trade_pr float, open_trade_pr_2 float",
        "ts_col": "event_ts",
        "series_ids": [
          "symbol"
        ],
        "data": [
          [
            "S1",
            "2020-08-01 00:00:00",
            340.21,
            9.0,
            349.21,
            10.0,
            340.21,
            9.0,
            349.21,
            10.0
          ],
          [
            "S1",
            "2020-08-01 00:01:00",
            350.32,
            6.0,
            353.32,
            8.0,
            350.32,
            6.0,
            353.32,
            8.0
          ],
          [
            "S1",
            "2020-09-01 00:01:00",
            361.1,
            5.0,
            361.1,
            5.0,
            361.1,
            5.0,
            361.1,
            5.0
          ],
          [
            "S1",
            "2020-09-01 00:19:00",
            362.1,
            4.0,
            362.1,
            4.0,
            362.1,
            4.0,
            362.1,
            4.0
          ]
        ]
      }
    },
    "test_resample_millis": {
      "init": {
        "schema": "symbol string, date string, event_ts string, trade_pr float, trade_pr_2 float",
        "ts_col": "event_ts",
        "series_ids": [
          "symbol"
        ],
        "data": [
          [
            "S1",
            "SAME_DT",
            "2020-08-01 00:00:10.12345",
            349.21,
            10.0
          ],
          [
            "S1",
            "SAME_DT",
            "2020-08-01 00:00:10.123",
            340.21,
            9.0
          ],
          [
            "S1",
            "SAME_DT",
            "2020-08-01 00:00:10.124",
            353.32,
            8.0
          ]
        ]
      },
      "expectedms": {
        "schema": "symbol string, event_ts string, date double, trade_pr double, trade_pr_2 double",
        "ts_col": "event_ts",
        "series_ids": [
          "symbol"
        ],
        "data": [
          [
            "S1",
            "2020-08-01 00:00:10.123",
            null,
            344.71,
            9.5
          ],
          [
            "S1",
            "2020-08-01 00:00:10.124",
            null,
            353.32,
            8.0
          ]
        ]
      }
    },
    "test_upsample": {
      "input": {
        "schema": "symbol string, date string, event_ts string, trade_pr float, trade_pr_2 float",
        "ts_col": "event_ts",
        "series_ids": [
          "symbol"
        ],
        "data": [
          [
            "S1",
            "SAME_DT",
            "2020-08-01 00:00:10",
            349.21,
            10.0
          ],
          [
            "S1",
            "SAME_DT",
            "2020-08-01 00:00:11",
            340.21,
            9.0
          ],
          [
            "S1",
            "SAME_DT",
            "2020-08-01 00:01:12",
            353.32,
            8.0
          ],
          [
            "S1",
            "SAME_DT",
            "2020-08-01 00:01:13",
            351.32,
            7.0
          ],
          [
            "S1",
            "SAME_DT",
            "2020-08-01 00:01:14",
            350.32,
            6.0
          ],
          [
            "S1",
            "SAME_DT",
            "2020-09-01 00:01:12",
            361.1,
            5.0
          ],
          [
            "S1",
            "SAME_DT",
            "2020-09-01 00:19:12",
            362.1,
            4.0
          ]
        ]
      },
      "expected": {
        "schema": "symbol string, event_ts string, floor_trade_pr float, floor_date string, floor_trade_pr_2 float",
        "ts_col": "event_ts",
        "series_ids": [
          "symbol"
        ],
        "data": [
          [
            "S1",
            "2020-08-01 00:00:00",
            349.21,
            "SAME_DT",
            10.0
          ],
          [
            "S1",
            "2020-08-01 00:01:00",
            353.32,
            "SAME_DT",
            8.0
          ],
          [
            "S1",
            "2020-09-01 00:01:00",
            361.1,
            "SAME_DT",
            5.0
          ],
          [
            "S1",
            "2020-09-01 00:19:00",
            362.1,
            "SAME_DT",
            4.0
          ]
        ]
      },
      "expected30m": {
        "schema": "symbol string, event_ts string, date double, trade_pr double, trade_pr_2 double",
        "ts_col": "event_ts",
        "series_ids": [
          "symbol"
        ],
        "data": [
          [
            "S1",
            "2020-08-01 00:00:00",
            0.0,
            348.88,
            8.0
          ],
          [
            "S1",
            "2020-08-01 00:05:00",
            0.0,
            0.0,
            0.0
          ],
          [
            "S1",
            "2020-09-01 00:00:00",
            0.0,
            361.1,
            5.0
          ],
          [
            "S1",
            "2020-09-01 00:15:00",
            0.0,
            362.1,
            4.0
          ]
        ]
      },
      "expectedbars": {
        "schema": "symbol string, event_ts string, close_trade_pr float, close_trade_pr_2 float, high_trade_pr float, high_trade_pr_2 float, low_trade_pr float, low_trade_pr_2 float, open_trade_pr float, open_trade_pr_2 float",
        "ts_col": "event_ts",
        "series_ids": [
          "symbol"
        ],
        "data": [
          [
            "S1",
            "2020-08-01 00:00:00",
            340.21,
            9.0,
            349.21,
            10.0,
            340.21,
            9.0,
            349.21,
            10.0
          ],
          [
            "S1",
            "2020-08-01 00:01:00",
            350.32,
            6.0,
            353.32,
            8.0,
            350.32,
            6.0,
            353.32,
            8.0
          ],
          [
            "S1",
            "2020-09-01 00:01:00",
            361.1,
            5.0,
            361.1,
            5.0,
            361.1,
            5.0,
            361.1,
            5.0
          ],
          [
            "S1",
            "2020-09-01 00:19:00",
            362.1,
            4.0,
            362.1,
            4.0,
            362.1,
            4.0,
            362.1,
            4.0
          ]
        ]
      }
    }
  },
  "ExtractStateIntervalsTest": {
    "test_eq_0": {
      "input": {
        "schema": "event_ts STRING NOT NULL, identifier_1 STRING NOT NULL, identifier_2 STRING NOT NULL, identifier_3 STRING NOT NULL, metric_1 FLOAT NOT NULL, metric_2 FLOAT NOT NULL, metric_3 FLOAT NOT NULL",
        "ts_col": "event_ts",
        "series_ids": [
          "identifier_1",
          "identifier_2",
          "identifier_3"
        ],
        "data": [
          [
            "2020-08-01 00:00:09",
            "v1",
            "foo",
            "bar",
            4.1,
            4.1,
            4.1
          ],
          [
            "2020-08-01 00:00:10",
            "v1",
            "foo",
            "bar",
            4.1,
            4.1,
            4.1
          ],
          [
            "2020-08-01 00:00:11",
            "v1",
            "foo",
            "bar",
            5.0,
            5.0,
            5.0
          ],
          [
            "2020-08-01 00:01:12",
            "v1",
            "foo",
            "bar",
            10.7,
            10.7,
            10.7
          ],
          [
            "2020-08-01 00:01:13",
            "v1",
            "foo",
            "bar",
            10.7,
            10.7,
            10.7
          ],
          [
            "2020-08-01 00:01:14",
            "v1",
            "foo",
            "bar",
            10.7,
            10.7,
            10.7
          ],
          [
            "2020-08-01 00:01:15",
            "v1",
            "foo",
            "bar",
            42.3,
            42.3,
            42.3
          ],
          [
            "2020-08-01 00:01:16",
            "v1",
            "foo",
            "bar",
            37.6,
            37.6,
            37.6
          ],
          [
            "2020-08-01 00:01:17",
            "v1",
            "foo",
            "bar",
            61.5,
            61.5,
            61.5
          ],
          [
            "2020-09-01 00:01:12",
            "v1",
            "foo",
            "bar",
            28.9,
            28.9,
            28.9
          ],
          [
            "2020-09-01 00:19:12",
            "v1",
            "foo",
            "bar",
            0.1,
            0.1,
            0.1
          ]
        ]
      },
      "expected": {
        "schema": "start_ts STRING NOT NULL, end_ts STRING NOT NULL,identifier_1 STRING NOT NULL,identifier_2 STRING NOT NULL,identifier_3 STRING NOT NULL",
        "other_ts_cols": [
          "start_ts",
          "end_ts"
        ],
        "data": [
          [
            "2020-08-01 00:00:09",
            "2020-08-01 00:00:10",
            "v1",
            "foo",
            "bar"
          ],
          [
            "2020-08-01 00:01:12",
            "2020-08-01 00:01:14",
            "v1",
            "foo",
            "bar"
          ]
        ]
      }
    },
    "test_eq_1": {
      "input": {
        "schema": "event_ts STRING NOT NULL, identifier_1 STRING NOT NULL, identifier_2 STRING NOT NULL, identifier_3 STRING NOT NULL, metric_1 FLOAT, metric_2 FLOAT, metric_3 FLOAT",
        "ts_col": "event_ts",
        "series_ids": [
          "identifier_1",
          "identifier_2",
          "identifier_3"
        ],
        "data": [
          [
            "2020-08-01 00:00:09",
            "v1",
            "foo",
            "bar",
            4.1,
            null,
            4.1
          ],
          [
            "2020-08-01 00:00:10",
            "v1",
            "foo",
            "bar",
            4.1,
            null,
            4.1
          ],
          [
            "2020-08-01 00:00:11",
            "v1",
            "foo",
            "bar",
            5.0,
            5.0,
            5.0
          ],
          [
            "2020-08-01 00:01:12",
            "v1",
            "foo",
            "bar",
            10.7,
            10.7,
            10.7
          ],
          [
            "2020-08-01 00:01:13",
            "v1",
            "foo",
            "bar",
            10.7,
            10.7,
            10.7
          ],
          [
            "2020-08-01 00:01:14",
            "v1",
            "foo",
            "bar",
            10.7,
            10.7,
            null
          ],
          [
            "2020-08-01 00:01:15",
            "v1",
            "foo",
            "bar",
            42.3,
            42.3,
            42.3
          ],
          [
            "2020-08-01 00:01:16",
            "v1",
            "foo",
            "bar",
            37.6,
            37.6,
            37.6
          ],
          [
            "2020-08-01 00:01:17",
            "v1",
            "foo",
            "bar",
            61.5,
            61.5,
            61.5
          ],
          [
            "2020-09-01 00:01:12",
            "v1",
            "foo",
            "bar",
            28.9,
            28.9,
            28.9
          ],
          [
            "2020-09-01 00:19:12",
            "v1",
            "foo",
            "bar",
            0.1,
            0.1,
            0.1
          ]
        ]
      },
      "expected": {
        "schema": "start_ts STRING NOT NULL, end_ts STRING NOT NULL,identifier_1 STRING NOT NULL,identifier_2 STRING NOT NULL,identifier_3 STRING NOT NULL",
        "other_ts_cols": [
          "start_ts",
          "end_ts"
        ],
        "data": [
          [
            "2020-08-01 00:01:12",
            "2020-08-01 00:01:13",
            "v1",
            "foo",
            "bar"
          ]
        ]
      }
    },
    "test_ne_0": {
      "input": {
        "schema": "event_ts STRING NOT NULL, identifier_1 STRING NOT NULL, identifier_2 STRING NOT NULL, identifier_3 STRING NOT NULL, metric_1 FLOAT NOT NULL, metric_2 FLOAT NOT NULL, metric_3 FLOAT NOT NULL",
        "ts_col": "event_ts",
        "series_ids": [
          "identifier_1",
          "identifier_2",
          "identifier_3"
        ],
        "data": [
          [
            "2020-08-01 00:00:09",
            "v1",
            "foo",
            "bar",
            4.1,
            4.1,
            4.1
          ],
          [
            "2020-08-01 00:00:10",
            "v1",
            "foo",
            "bar",
            4.1,
            4.1,
            4.1
          ],
          [
            "2020-08-01 00:00:11",
            "v1",
            "foo",
            "bar",
            5.0,
            5.0,
            5.0
          ],
          [
            "2020-08-01 00:01:12",
            "v1",
            "foo",
            "bar",
            10.7,
            10.7,
            10.7
          ],
          [
            "2020-08-01 00:01:13",
            "v1",
            "foo",
            "bar",
            10.7,
            10.7,
            10.7
          ],
          [
            "2020-08-01 00:01:14",
            "v1",
            "foo",
            "bar",
            10.7,
            10.7,
            10.7
          ],
          [
            "2020-08-01 00:01:15",
            "v1",
            "foo",
            "bar",
            42.3,
            42.3,
            42.3
          ],
          [
            "2020-08-01 00:01:16",
            "v1",
            "foo",
            "bar",
            37.6,
            37.6,
            37.6
          ],
          [
            "2020-08-01 00:01:17",
            "v1",
            "foo",
            "bar",
            61.5,
            61.5,
            61.5
          ],
          [
            "2020-09-01 00:01:12",
            "v1",
            "foo",
            "bar",
            28.9,
            28.9,
            28.9
          ],
          [
            "2020-09-01 00:19:12",
            "v1",
            "foo",
            "bar",
            0.1,
            0.1,
            0.1
          ]
        ]
      },
      "expected": {
        "schema": "start_ts STRING NOT NULL, end_ts STRING NOT NULL,identifier_1 STRING NOT NULL,identifier_2 STRING NOT NULL,identifier_3 STRING NOT NULL",
        "other_ts_cols": [
          "start_ts",
          "end_ts"
        ],
        "data": [
          [
            "2020-08-01 00:00:10",
            "2020-08-01 00:01:12",
            "v1",
            "foo",
            "bar"
          ],
          [
            "2020-08-01 00:01:14",
            "2020-09-01 00:19:12",
            "v1",
            "foo",
            "bar"
          ]
        ]
      }
    },
    "test_ne_1": {
      "input": {
        "schema": "event_ts STRING NOT NULL, identifier_1 STRING NOT NULL, identifier_2 STRING NOT NULL, identifier_3 STRING NOT NULL, metric_1 FLOAT NOT NULL, metric_2 FLOAT NOT NULL, metric_3 FLOAT NOT NULL",
        "ts_col": "event_ts",
        "series_ids": [
          "identifier_1",
          "identifier_2",
          "identifier_3"
        ],
        "data": [
          [
            "2020-08-01 00:00:09",
            "v1",
            "foo",
            "bar",
            4.1,
            4.1,
            4.1
          ],
          [
            "2020-08-01 00:00:10",
            "v1",
            "foo",
            "bar",
            4.1,
            4.0,
            4.2
          ],
          [
            "2020-08-01 00:00:11",
            "v1",
            "foo",
            "bar",
            4.3,
            4.1,
            4.7
          ]
        ]
      },
      "expected": {
        "schema": "start_ts STRING NOT NULL, end_ts STRING NOT NULL,identifier_1 STRING NOT NULL,identifier_2 STRING NOT NULL,identifier_3 STRING NOT NULL",
        "other_ts_cols": [
          "start_ts",
          "end_ts"
        ],
        "data": [
          [
            "2020-08-01 00:00:10",
            "2020-08-01 00:00:11",
            "v1",
            "foo",
            "bar"
          ]
        ]
      }
    },
    "test_gt_0": {
      "input": {
        "schema": "event_ts STRING NOT NULL, identifier_1 STRING NOT NULL, identifier_2 STRING NOT NULL, identifier_3 STRING NOT NULL, metric_1 FLOAT NOT NULL, metric_2 FLOAT NOT NULL, metric_3 FLOAT NOT NULL",
        "ts_col": "event_ts",
        "series_ids": [
          "identifier_1",
          "identifier_2",
          "identifier_3"
        ],
        "data": [
          [
            "2020-08-01 00:00:09",
            "v1",
            "foo",
            "bar",
            4.1,
            4.1,
            4.1
          ],
          [
            "2020-08-01 00:00:10",
            "v1",
            "foo",
            "bar",
            4.1,
            4.1,
            4.1
          ],
          [
            "2020-08-01 00:00:11",
            "v1",
            "foo",
            "bar",
            5.0,
            5.0,
            5.0
          ],
          [
            "2020-08-01 00:01:12",
            "v1",
            "foo",
            "bar",
            10.7,
            10.7,
            10.7
          ],
          [
            "2020-08-01 00:01:13",
            "v1",
            "foo",
            "bar",
            10.7,
            10.7,
            10.7
          ],
          [
            "2020-08-01 00:01:14",
            "v1",
            "foo",
            "bar",
            10.7,
            10.7,
            10.7
          ],
          [
            "2020-08-01 00:01:15",
            "v1",
            "foo",
            "bar",
            42.3,
            42.3,
            42.3
          ],
          [
            "2020-08-01 00:01:16",
            "v1",
            "foo",
            "bar",
            37.6,
            37.6,
            37.6
          ],
          [
            "2020-08-01 00:01:17",
            "v1",
            "foo",
            "bar",
            61.5,
            61.5,
            61.5
          ],
          [
            "2020-09-01 00:01:12",
            "v1",
            "foo",
            "bar",
            28.9,
            28.9,
            28.9
          ],
          [
            "2020-09-01 00:19:12",
            "v1",
            "foo",
            "bar",
            0.1,
            0.1,
            0.1
          ]
        ]
      },
      "expected": {
        "schema": "start_ts STRING NOT NULL, end_ts STRING NOT NULL,identifier_1 STRING NOT NULL,identifier_2 STRING NOT NULL,identifier_3 STRING NOT NULL",
        "other_ts_cols": [
          "start_ts",
          "end_ts"
        ],
        "data": [
          [
            "2020-08-01 00:00:10",
            "2020-08-01 00:01:12",
            "v1",
            "foo",
            "bar"
          ],
          [
            "2020-08-01 00:01:14",
            "2020-08-01 00:01:15",
            "v1",
            "foo",
            "bar"
          ],
          [
            "2020-08-01 00:01:16",
            "2020-08-01 00:01:17",
            "v1",
            "foo",
            "bar"
          ]
        ]
      }
    },
    "test_gt_1": {
      "input": {
        "schema": "event_ts STRING NOT NULL, identifier_1 STRING NOT NULL, identifier_2 STRING NOT NULL, identifier_3 STRING NOT NULL, metric_1 FLOAT NOT NULL, metric_2 FLOAT NOT NULL, metric_3 FLOAT NOT NULL",
        "ts_col": "event_ts",
        "series_ids": [
          "identifier_1",
          "identifier_2",
          "identifier_3"
        ],
        "data": [
          [
            "2020-08-01 00:00:09",
            "v1",
            "foo",
            "bar",
            4.3,
            4.1,
            4.7
          ],
          [
            "2020-08-01 00:00:10",
            "v1",
            "foo",
            "bar",
            4.4,
            4.0,
            4.6
          ],
          [
            "2020-08-01 00:00:11",
            "v1",
            "foo",
            "bar",
            4.5,
            4.1,
            4.7
          ]
        ]
      },
      "expected": {
        "schema": "start_ts STRING NOT NULL, end_ts STRING NOT NULL,identifier_1 STRING NOT NULL,identifier_2 STRING NOT NULL,identifier_3 STRING NOT NULL",
        "other_ts_cols": [
          "start_ts",
          "end_ts"
        ],
        "data": [
          [
            "2020-08-01 00:00:10",
            "2020-08-01 00:00:11",
            "v1",
            "foo",
            "bar"
          ]
        ]
      }
    },
    "test_lt_0": {
      "input": {
        "schema": "event_ts STRING NOT NULL, identifier_1 STRING NOT NULL, identifier_2 STRING NOT NULL, identifier_3 STRING NOT NULL, metric_1 FLOAT NOT NULL, metric_2 FLOAT NOT NULL, metric_3 FLOAT NOT NULL",
        "ts_col": "event_ts",
        "series_ids": [
          "identifier_1",
          "identifier_2",
          "identifier_3"
        ],
        "data": [
          [
            "2020-08-01 00:00:09",
            "v1",
            "foo",
            "bar",
            4.1,
            4.1,
            4.1
          ],
          [
            "2020-08-01 00:00:10",
            "v1",
            "foo",
            "bar",
            4.1,
            4.1,
            4.1
          ],
          [
            "2020-08-01 00:00:11",
            "v1",
            "foo",
            "bar",
            5.0,
            5.0,
            5.0
          ],
          [
            "2020-08-01 00:01:12",
            "v1",
            "foo",
            "bar",
            10.7,
            10.7,
            10.7
          ],
          [
            "2020-08-01 00:01:13",
            "v1",
            "foo",
            "bar",
            10.7,
            10.7,
            10.7
          ],
          [
            "2020-08-01 00:01:14",
            "v1",
            "foo",
            "bar",
            10.7,
            10.7,
            10.7
          ],
          [
            "2020-08-01 00:01:15",
            "v1",
            "foo",
            "bar",
            42.3,
            42.3,
            42.3
          ],
          [
            "2020-08-01 00:01:16",
            "v1",
            "foo",
            "bar",
            37.6,
            37.6,
            37.6
          ],
          [
            "2020-08-01 00:01:17",
            "v1",
            "foo",
            "bar",
            61.5,
            61.5,
            61.5
          ],
          [
            "2020-09-01 00:01:12",
            "v1",
            "foo",
            "bar",
            28.9,
            28.9,
            28.9
          ],
          [
            "2020-09-01 00:19:12",
            "v1",
            "foo",
            "bar",
            0.1,
            0.1,
            0.1
          ]
        ]
      },
      "expected": {
        "schema": "start_ts STRING NOT NULL, end_ts STRING NOT NULL,identifier_1 STRING NOT NULL,identifier_2 STRING NOT NULL,identifier_3 STRING NOT NULL",
        "other_ts_cols": [
          "start_ts",
          "end_ts"
        ],
        "data": [
          [
            "2020-08-01 00:01:15",
            "2020-08-01 00:01:16",
            "v1",
            "foo",
            "bar"
          ],
          [
            "2020-08-01 00:01:17",
            "2020-09-01 00:19:12",
            "v1",
            "foo",
            "bar"
          ]
        ]
      }
    },
    "test_lt_1": {
      "input": {
        "schema": "event_ts STRING NOT NULL, identifier_1 STRING NOT NULL, identifier_2 STRING NOT NULL, identifier_3 STRING NOT NULL, metric_1 FLOAT NOT NULL, metric_2 FLOAT NOT NULL, metric_3 FLOAT NOT NULL",
        "ts_col": "event_ts",
        "series_ids": [
          "identifier_1",
          "identifier_2",
          "identifier_3"
        ],
        "data": [
          [
            "2020-08-01 00:00:09",
            "v1",
            "foo",
            "bar",
            4.3,
            4.1,
            4.7
          ],
          [
            "2020-08-01 00:00:10",
            "v1",
            "foo",
            "bar",
            4.2,
            4.2,
            4.8
          ],
          [
            "2020-08-01 00:00:11",
            "v1",
            "foo",
            "bar",
            4.1,
            4.1,
            4.7
          ]
        ]
      },
      "expected": {
        "schema": "start_ts STRING NOT NULL, end_ts STRING NOT NULL,identifier_1 STRING NOT NULL,identifier_2 STRING NOT NULL,identifier_3 STRING NOT NULL",
        "other_ts_cols": [
          "start_ts",
          "end_ts"
        ],
        "data": [
          [
            "2020-08-01 00:00:10",
            "2020-08-01 00:00:11",
            "v1",
            "foo",
            "bar"
          ]
        ]
      }
    },
    "test_gte_0": {
      "input": {
        "schema": "event_ts STRING NOT NULL, identifier_1 STRING NOT NULL, identifier_2 STRING NOT NULL, identifier_3 STRING NOT NULL, metric_1 FLOAT NOT NULL, metric_2 FLOAT NOT NULL, metric_3 FLOAT NOT NULL",
        "ts_col": "event_ts",
        "series_ids": [
          "identifier_1",
          "identifier_2",
          "identifier_3"
        ],
        "data": [
          [
            "2020-08-01 00:00:09",
            "v1",
            "foo",
            "bar",
            4.1,
            4.1,
            4.1
          ],
          [
            "2020-08-01 00:00:10",
            "v1",
            "foo",
            "bar",
            4.1,
            4.1,
            4.1
          ],
          [
            "2020-08-01 00:00:11",
            "v1",
            "foo",
            "bar",
            5.0,
            5.0,
            5.0
          ],
          [
            "2020-08-01 00:01:12",
            "v1",
            "foo",
            "bar",
            10.7,
            10.7,
            10.7
          ],
          [
            "2020-08-01 00:01:13",
            "v1",
            "foo",
            "bar",
            10.7,
            10.7,
            10.7
          ],
          [
            "2020-08-01 00:01:14",
            "v1",
            "foo",
            "bar",
            10.7,
            10.7,
            10.7
          ],
          [
            "2020-08-01 00:01:15",
            "v1",
            "foo",
            "bar",
            42.3,
            42.3,
            42.3
          ],
          [
            "2020-08-01 00:01:16",
            "v1",
            "foo",
            "bar",
            37.6,
            37.6,
            37.6
          ],
          [
            "2020-08-01 00:01:17",
            "v1",
            "foo",
            "bar",
            61.5,
            61.5,
            61.5
          ],
          [
            "2020-09-01 00:01:12",
            "v1",
            "foo",
            "bar",
            28.9,
            28.9,
            28.9
          ],
          [
            "2020-09-01 00:19:12",
            "v1",
            "foo",
            "bar",
            0.1,
            0.1,
            0.1
          ]
        ]
      },
      "expected": {
        "schema": "start_ts STRING NOT NULL, end_ts STRING NOT NULL,identifier_1 STRING NOT NULL,identifier_2 STRING NOT NULL,identifier_3 STRING NOT NULL",
        "other_ts_cols": [
          "start_ts",
          "end_ts"
        ],
        "data": [
          [
            "2020-08-01 00:00:09",
            "2020-08-01 00:01:15",
            "v1",
            "foo",
            "bar"
          ],
          [
            "2020-08-01 00:01:16",
            "2020-08-01 00:01:17",
            "v1",
            "foo",
            "bar"
          ]
        ]
      }
    },
    "test_gte_1": {
      "input": {
        "schema": "event_ts STRING NOT NULL, identifier_1 STRING NOT NULL, identifier_2 STRING NOT NULL, identifier_3 STRING NOT NULL, metric_1 FLOAT NOT NULL, metric_2 FLOAT NOT NULL, metric_3 FLOAT NOT NULL",
        "ts_col": "event_ts",
        "series_ids": [
          "identifier_1",
          "identifier_2",
          "identifier_3"
        ],
        "data": [
          [
            "2020-08-01 00:00:09",
            "v1",
            "foo",
            "bar",
            4.3,
            4.1,
            4.7
          ],
          [
            "2020-08-01 00:00:10",
            "v1",
            "foo",
            "bar",
            4.4,
            4.0,
            4.6
          ],
          [
            "2020-08-01 00:00:11",
            "v1",
            "foo",
            "bar",
            4.5,
            4.0,
            4.7
          ]
        ]
      },
      "expected": {
        "schema": "start_ts STRING NOT NULL, end_ts STRING NOT NULL,identifier_1 STRING NOT NULL,identifier_2 STRING NOT NULL,identifier_3 STRING NOT NULL",
        "other_ts_cols": [
          "start_ts",
          "end_ts"
        ],
        "data": [
          [
            "2020-08-01 00:00:10",
            "2020-08-01 00:00:11",
            "v1",
            "foo",
            "bar"
          ]
        ]
      }
    },
    "test_lte_0": {
      "input": {
        "schema": "event_ts STRING NOT NULL, identifier_1 STRING NOT NULL, identifier_2 STRING NOT NULL, identifier_3 STRING NOT NULL, metric_1 FLOAT NOT NULL, metric_2 FLOAT NOT NULL, metric_3 FLOAT NOT NULL",
        "ts_col": "event_ts",
        "series_ids": [
          "identifier_1",
          "identifier_2",
          "identifier_3"
        ],
        "data": [
          [
            "2020-08-01 00:00:09",
            "v1",
            "foo",
            "bar",
            4.1,
            4.1,
            4.1
          ],
          [
            "2020-08-01 00:00:10",
            "v1",
            "foo",
            "bar",
            4.1,
            4.1,
            4.1
          ],
          [
            "2020-08-01 00:00:11",
            "v1",
            "foo",
            "bar",
            5.0,
            5.0,
            5.0
          ],
          [
            "2020-08-01 00:01:12",
            "v1",
            "foo",
            "bar",
            10.7,
            10.7,
            10.7
          ],
          [
            "2020-08-01 00:01:13",
            "v1",
            "foo",
            "bar",
            10.7,
            10.7,
            10.7
          ],
          [
            "2020-08-01 00:01:14",
            "v1",
            "foo",
            "bar",
            10.7,
            10.7,
            10.7
          ],
          [
            "2020-08-01 00:01:15",
            "v1",
            "foo",
            "bar",
            42.3,
            42.3,
            42.3
          ],
          [
            "2020-08-01 00:01:16",
            "v1",
            "foo",
            "bar",
            37.6,
            37.6,
            37.6
          ],
          [
            "2020-08-01 00:01:17",
            "v1",
            "foo",
            "bar",
            61.5,
            61.5,
            61.5
          ],
          [
            "2020-09-01 00:01:12",
            "v1",
            "foo",
            "bar",
            28.9,
            28.9,
            28.9
          ],
          [
            "2020-09-01 00:19:12",
            "v1",
            "foo",
            "bar",
            0.1,
            0.1,
            0.1
          ]
        ]
      },
      "expected": {
        "schema": "start_ts STRING NOT NULL, end_ts STRING NOT NULL,identifier_1 STRING NOT NULL,identifier_2 STRING NOT NULL,identifier_3 STRING NOT NULL",
        "other_ts_cols": [
          "start_ts",
          "end_ts"
        ],
        "data": [
          [
            "2020-08-01 00:00:09",
            "2020-08-01 00:00:10",
            "v1",
            "foo",
            "bar"
          ],
          [
            "2020-08-01 00:01:12",
            "2020-08-01 00:01:14",
            "v1",
            "foo",
            "bar"
          ],
          [
            "2020-08-01 00:01:15",
            "2020-08-01 00:01:16",
            "v1",
            "foo",
            "bar"
          ],
          [
            "2020-08-01 00:01:17",
            "2020-09-01 00:19:12",
            "v1",
            "foo",
            "bar"
          ]
        ]
      }
    },
    "test_lte_1": {
      "input": {
        "schema": "event_ts STRING NOT NULL, identifier_1 STRING NOT NULL, identifier_2 STRING NOT NULL, identifier_3 STRING NOT NULL, metric_1 FLOAT NOT NULL, metric_2 FLOAT NOT NULL, metric_3 FLOAT NOT NULL",
        "ts_col": "event_ts",
        "series_ids": [
          "identifier_1",
          "identifier_2",
          "identifier_3"
        ],
        "data": [
          [
            "2020-08-01 00:00:09",
            "v1",
            "foo",
            "bar",
            4.3,
            4.1,
            4.7
          ],
          [
            "2020-08-01 00:00:10",
            "v1",
            "foo",
            "bar",
            4.2,
            4.2,
            4.8
          ],
          [
            "2020-08-01 00:00:11",
            "v1",
            "foo",
            "bar",
            4.1,
            4.2,
            4.7
          ]
        ]
      },
      "expected": {
        "schema": "start_ts STRING NOT NULL, end_ts STRING NOT NULL,identifier_1 STRING NOT NULL,identifier_2 STRING NOT NULL,identifier_3 STRING NOT NULL",
        "other_ts_cols": [
          "start_ts",
          "end_ts"
        ],
        "data": [
          [
            "2020-08-01 00:00:10",
            "2020-08-01 00:00:11",
            "v1",
            "foo",
            "bar"
          ]
        ]
      }
    },
    "test_threshold_fn": {
      "input": {
        "schema": "event_ts STRING NOT NULL, identifier_1 STRING NOT NULL, identifier_2 STRING NOT NULL, identifier_3 STRING NOT NULL, metric_1 FLOAT NOT NULL, metric_2 FLOAT NOT NULL, metric_3 FLOAT NOT NULL",
        "ts_col": "event_ts",
        "series_ids": [
          "identifier_1",
          "identifier_2",
          "identifier_3"
        ],
        "data": [
          [
            "2020-08-01 00:00:09",
            "v1",
            "foo",
            "bar",
            4.1,
            4.1,
            4.1
          ],
          [
            "2020-08-01 00:00:10",
            "v1",
            "foo",
            "bar",
            4.1,
            4.1,
            4.1
          ],
          [
            "2020-08-01 00:00:11",
            "v1",
            "foo",
            "bar",
            5.0,
            5.0,
            5.0
          ],
          [
            "2020-08-01 00:01:12",
            "v1",
            "foo",
            "bar",
            10.7,
            10.7,
            10.7
          ],
          [
            "2020-08-01 00:01:13",
            "v1",
            "foo",
            "bar",
            10.7,
            10.7,
            10.7
          ],
          [
            "2020-08-01 00:01:14",
            "v1",
            "foo",
            "bar",
            10.7,
            10.7,
            10.7
          ],
          [
            "2020-08-01 00:01:15",
            "v1",
            "foo",
            "bar",
            42.3,
            42.3,
            42.3
          ],
          [
            "2020-08-01 00:01:16",
            "v1",
            "foo",
            "bar",
            37.6,
            37.6,
            37.6
          ],
          [
            "2020-08-01 00:01:17",
            "v1",
            "foo",
            "bar",
            61.5,
            61.5,
            61.5
          ],
          [
            "2020-09-01 00:01:12",
            "v1",
            "foo",
            "bar",
            28.9,
            28.9,
            28.9
          ],
          [
            "2020-09-01 00:19:12",
            "v1",
            "foo",
            "bar",
            0.1,
            0.1,
            0.1
          ]
        ]
      },
      "expected": {
        "schema": "start_ts: STRING, end_ts: STRING, identifier_1 STRING NOT NULL, identifier_2 STRING NOT NULL ,identifier_3 STRING NOT NULL",
        "other_ts_cols": [
          "start_ts",
          "end_ts"
        ],
        "data": [
          [
            "2020-08-01 00:00:09",
            "2020-08-01 00:00:10",
            "v1",
            "foo",
            "bar"
          ],
          [
            "2020-08-01 00:01:12",
            "2020-08-01 00:01:14",
            "v1",
            "foo",
            "bar"
          ]
        ]
      }
    },
    "test_null_safe_eq_0": {
      "input": {
        "schema": "event_ts STRING NOT NULL, identifier_1 STRING NOT NULL, identifier_2 STRING NOT NULL, identifier_3 STRING NOT NULL, metric_1 FLOAT, metric_2 FLOAT, metric_3 FLOAT",
        "ts_col": "event_ts",
        "series_ids": [
          "identifier_1",
          "identifier_2",
          "identifier_3"
        ],
        "data": [
          [
            "2020-08-01 00:00:09",
            "v1",
            "foo",
            "bar",
            4.1,
            null,
            4.1
          ],
          [
            "2020-08-01 00:00:10",
            "v1",
            "foo",
            "bar",
            4.1,
            null,
            4.1
          ],
          [
            "2020-08-01 00:00:11",
            "v1",
            "foo",
            "bar",
            5.0,
            5.0,
            5.0
          ],
          [
            "2020-08-01 00:01:12",
            "v1",
            "foo",
            "bar",
            null,
            10.7,
            10.7
          ],
          [
            "2020-08-01 00:01:13",
            "v1",
            "foo",
            "bar",
            null,
            10.7,
            10.7
          ],
          [
            "2020-08-01 00:01:14",
            "v1",
            "foo",
            "bar",
            null,
            10.7,
            10.7
          ],
          [
            "2020-08-01 00:01:15",
            "v1",
            "foo",
            "bar",
            42.3,
            42.3,
            42.3
          ],
          [
            "2020-08-01 00:01:16",
            "v1",
            "foo",
            "bar",
            37.6,
            37.6,
            37.6
          ],
          [
            "2020-08-01 00:01:17",
            "v1",
            "foo",
            "bar",
            61.5,
            61.5,
            61.5
          ],
          [
            "2020-09-01 00:01:12",
            "v1",
            "foo",
            "bar",
            28.9,
            28.9,
            28.9
          ],
          [
            "2020-09-01 00:19:12",
            "v1",
            "foo",
            "bar",
            0.1,
            0.1,
            0.1
          ]
        ]
      },
      "expected": {
        "schema": "start_ts STRING NOT NULL, end_ts STRING NOT NULL,identifier_1 STRING NOT NULL,identifier_2 STRING NOT NULL,identifier_3 STRING NOT NULL",
        "other_ts_cols": [
          "start_ts",
          "end_ts"
        ],
        "data": [
          [
            "2020-08-01 00:00:09",
            "2020-08-01 00:00:10",
            "v1",
            "foo",
            "bar"
          ],
          [
            "2020-08-01 00:01:12",
            "2020-08-01 00:01:14",
            "v1",
            "foo",
            "bar"
          ]
        ]
      }
    },
    "test_null_safe_eq_1": {
      "input": {
        "schema": "event_ts STRING NOT NULL, identifier_1 STRING NOT NULL, identifier_2 STRING NOT NULL, identifier_3 STRING NOT NULL, metric_1 FLOAT, metric_2 FLOAT, metric_3 FLOAT",
        "ts_col": "event_ts",
        "series_ids": [
          "identifier_1",
          "identifier_2",
          "identifier_3"
        ],
        "data": [
          [
            "2020-08-01 00:00:09",
            "v1",
            "foo",
            "bar",
            4.1,
            null,
            4.1
          ],
          [
            "2020-08-01 00:00:10",
            "v1",
            "foo",
            "bar",
            4.1,
            4.1,
            null
          ],
          [
            "2020-08-01 00:00:11",
            "v1",
            "foo",
            "bar",
            5.0,
            5.0,
            5.0
          ],
          [
            "2020-08-01 00:01:12",
            "v1",
            "foo",
            "bar",
            null,
            10.7,
            10.7
          ],
          [
            "2020-08-01 00:01:13",
            "v1",
            "foo",
            "bar",
            null,
            10.7,
            10.7
          ],
          [
            "2020-08-01 00:01:14",
            "v1",
            "foo",
            "bar",
            10.7,
            null,
            10.7
          ],
          [
            "2020-08-01 00:01:15",
            "v1",
            "foo",
            "bar",
            42.3,
            42.3,
            42.3
          ],
          [
            "2020-08-01 00:01:16",
            "v1",
            "foo",
            "bar",
            37.6,
            37.6,
            37.6
          ],
          [
            "2020-08-01 00:01:17",
            "v1",
            "foo",
            "bar",
            61.5,
            61.5,
            61.5
          ],
          [
            "2020-09-01 00:01:12",
            "v1",
            "foo",
            "bar",
            28.9,
            28.9,
            28.9
          ],
          [
            "2020-09-01 00:19:12",
            "v1",
            "foo",
            "bar",
            0.1,
            0.1,
            0.1
          ]
        ]
      },
      "expected": {
        "schema": "start_ts STRING NOT NULL, end_ts STRING NOT NULL,identifier_1 STRING NOT NULL,identifier_2 STRING NOT NULL,identifier_3 STRING NOT NULL",
        "other_ts_cols": [
          "start_ts",
          "end_ts"
        ],
        "data": [
          [
            "2020-08-01 00:01:12",
            "2020-08-01 00:01:13",
            "v1",
            "foo",
            "bar"
          ]
        ]
      }
    },
    "test_adjacent_intervals": {
      "input": {
        "schema": "event_ts STRING NOT NULL, identifier_1 STRING NOT NULL, identifier_2 STRING NOT NULL, identifier_3 STRING NOT NULL, metric_1 FLOAT, metric_2 FLOAT, metric_3 FLOAT",
        "ts_col": "event_ts",
        "series_ids": [
          "identifier_1",
          "identifier_2",
          "identifier_3"
        ],
        "data": [
          [
            "2020-08-01 00:00:09",
            "v1",
            "foo",
            "bar",
            4.1,
            4.1,
            4.1
          ],
          [
            "2020-08-01 00:00:10",
            "v1",
            "foo",
            "bar",
            4.1,
            4.1,
            4.1
          ],
          [
            "2020-08-01 00:00:11",
            "v1",
            "foo",
            "bar",
            5.0,
            5.0,
            5.0
          ],
          [
            "2020-08-01 00:00:12",
            "v1",
            "foo",
            "bar",
            5.0,
            5.0,
            5.0
          ],
          [
            "2020-08-01 00:01:12",
            "v1",
            "foo",
            "bar",
            10.7,
            10.7,
            10.7
          ],
          [
            "2020-08-01 00:01:13",
            "v1",
            "foo",
            "bar",
            10.7,
            10.7,
            10.7
          ],
          [
            "2020-08-01 00:01:14",
            "v1",
            "foo",
            "bar",
            10.7,
            10.7,
            10.7
          ]
        ]
      },
      "expected": {
        "schema": "start_ts STRING NOT NULL, end_ts STRING NOT NULL,identifier_1 STRING NOT NULL,identifier_2 STRING NOT NULL,identifier_3 STRING NOT NULL",
        "other_ts_cols": [
          "start_ts",
          "end_ts"
        ],
        "data": [
          [
            "2020-08-01 00:00:09",
            "2020-08-01 00:00:10",
            "v1",
            "foo",
            "bar"
          ],
          [
            "2020-08-01 00:00:11",
            "2020-08-01 00:00:12",
            "v1",
            "foo",
            "bar"
          ],
          [
            "2020-08-01 00:01:12",
            "2020-08-01 00:01:14",
            "v1",
            "foo",
            "bar"
          ]
        ]
      }
    },
    "test_invalid_state_definition_str": {
      "input": {
        "schema": "event_ts STRING NOT NULL, identifier_1 STRING NOT NULL, identifier_2 STRING NOT NULL, identifier_3 STRING NOT NULL, metric_1 FLOAT NOT NULL, metric_2 FLOAT NOT NULL, metric_3 FLOAT NOT NULL",
        "ts_col": "event_ts",
        "series_ids": [
          "identifier_1",
          "identifier_2",
          "identifier_3"
        ],
        "data": [
          [
            "2020-08-01 00:00:09",
            "v1",
            "foo",
            "bar",
            4.1,
            4.1,
            4.1
          ]
        ]
      }
    },
    "test_invalid_state_definition_type": {
      "input": {
        "schema": "event_ts STRING NOT NULL, identifier_1 STRING NOT NULL, identifier_2 STRING NOT NULL, identifier_3 STRING NOT NULL, metric_1 FLOAT NOT NULL, metric_2 FLOAT NOT NULL, metric_3 FLOAT NOT NULL",
        "ts_col": "event_ts",
        "series_ids": [
          "identifier_1",
          "identifier_2",
          "identifier_3"
        ],
        "data": [
          [
            "2020-08-01 00:00:09",
            "v1",
            "foo",
            "bar",
            4.1,
            4.1,
            4.1
          ]
        ]
      }
    }
  }
}