{
  "basic_join": {
    "left": {
      "tsdf": {
        "ts_col": "timestamp",
        "series_ids": ["symbol"]
      },
      "df": {
        "schema": "timestamp string, symbol string, price double, volume int",
        "ts_convert": ["timestamp"],
        "data": [
          ["2021-01-01 10:00:00", "AAPL", 100.0, 10],
          ["2021-01-01 10:05:00", "AAPL", 101.0, 20],
          ["2021-01-01 10:10:00", "AAPL", 102.0, 15],
          ["2021-01-01 10:00:00", "GOOGL", 2000.0, 5],
          ["2021-01-01 10:05:00", "GOOGL", 2010.0, 10]
        ]
      }
    },
    "right": {
      "tsdf": {
        "ts_col": "timestamp",
        "series_ids": ["symbol"]
      },
      "df": {
        "schema": "timestamp string, symbol string, bid double, ask double",
        "ts_convert": ["timestamp"],
        "data": [
          ["2021-01-01 09:59:00", "AAPL", 99.5, 100.5],
          ["2021-01-01 10:03:00", "AAPL", 100.5, 101.5],
          ["2021-01-01 10:08:00", "AAPL", 101.5, 102.5],
          ["2021-01-01 09:59:00", "GOOGL", 1995.0, 2005.0],
          ["2021-01-01 10:03:00", "GOOGL", 2005.0, 2015.0]
        ]
      }
    },
    "expected_broadcast": {
      "tsdf": {
        "ts_col": "timestamp",
        "series_ids": ["symbol"]
      },
      "df": {
        "schema": "timestamp string, symbol string, price double, volume int, right_timestamp string, right_bid double, right_ask double",
        "ts_convert": ["timestamp", "right_timestamp"],
        "data": [
          ["2021-01-01 10:00:00", "AAPL", 100.0, 10, "2021-01-01 09:59:00", 99.5, 100.5],
          ["2021-01-01 10:05:00", "AAPL", 101.0, 20, "2021-01-01 10:03:00", 100.5, 101.5],
          ["2021-01-01 10:10:00", "AAPL", 102.0, 15, "2021-01-01 10:08:00", 101.5, 102.5],
          ["2021-01-01 10:00:00", "GOOGL", 2000.0, 5, "2021-01-01 09:59:00", 1995.0, 2005.0],
          ["2021-01-01 10:05:00", "GOOGL", 2010.0, 10, "2021-01-01 10:03:00", 2005.0, 2015.0]
        ]
      }
    }
  },
  "tolerance_test": {
    "left": {
      "tsdf": {
        "ts_col": "timestamp",
        "series_ids": ["id"]
      },
      "df": {
        "schema": "timestamp string, id string, value double",
        "ts_convert": ["timestamp"],
        "data": [
          ["2021-01-01 10:00:00", "A", 100.0],
          ["2021-01-01 10:05:00", "A", 105.0],
          ["2021-01-01 10:10:00", "A", 110.0]
        ]
      }
    },
    "right": {
      "tsdf": {
        "ts_col": "timestamp",
        "series_ids": ["id"]
      },
      "df": {
        "schema": "timestamp string, id string, factor double",
        "ts_convert": ["timestamp"],
        "data": [
          ["2021-01-01 09:58:00", "A", 0.9],
          ["2021-01-01 10:04:00", "A", 1.0],
          ["2021-01-01 10:06:00", "A", 1.1]
        ]
      }
    },
    "expected_with_tolerance_120": {
      "tsdf": {
        "ts_col": "timestamp",
        "series_ids": ["id"]
      },
      "df": {
        "schema": "timestamp string, id string, value double, right_timestamp string, right_factor double",
        "ts_convert": ["timestamp", "right_timestamp"],
        "data": [
          ["2021-01-01 10:00:00", "A", 100.0, null, null],
          ["2021-01-01 10:05:00", "A", 105.0, "2021-01-01 10:04:00", 1.0],
          ["2021-01-01 10:10:00", "A", 110.0, null, null]
        ]
      }
    }
  },
  "null_handling": {
    "left": {
      "tsdf": {
        "ts_col": "timestamp",
        "series_ids": ["symbol"]
      },
      "df": {
        "schema": "timestamp string, symbol string, price double",
        "ts_convert": ["timestamp"],
        "data": [
          ["2021-01-01 10:00:00", "AAPL", 100.0],
          ["2021-01-01 10:05:00", "AAPL", null],
          ["2021-01-01 10:10:00", "AAPL", 102.0]
        ]
      }
    },
    "right": {
      "tsdf": {
        "ts_col": "timestamp",
        "series_ids": ["symbol"]
      },
      "df": {
        "schema": "timestamp string, symbol string, quote double",
        "ts_convert": ["timestamp"],
        "data": [
          ["2021-01-01 09:59:00", "AAPL", 99.5],
          ["2021-01-01 10:03:00", "AAPL", null],
          ["2021-01-01 10:08:00", "AAPL", 101.5]
        ]
      }
    },
    "expected_skip_nulls": {
      "tsdf": {
        "ts_col": "timestamp",
        "series_ids": ["symbol"]
      },
      "df": {
        "schema": "timestamp string, symbol string, price double, right_timestamp string, right_quote double",
        "ts_convert": ["timestamp", "right_timestamp"],
        "data": [
          ["2021-01-01 10:00:00", "AAPL", 100.0, "2021-01-01 09:59:00", 99.5],
          ["2021-01-01 10:05:00", "AAPL", null, "2021-01-01 09:59:00", 99.5],
          ["2021-01-01 10:10:00", "AAPL", 102.0, "2021-01-01 10:08:00", 101.5]
        ]
      }
    }
  },
  "empty_dataframes": {
    "empty": {
      "tsdf": {
        "ts_col": "timestamp",
        "series_ids": ["symbol"]
      },
      "df": {
        "schema": "timestamp string, symbol string, value double",
        "ts_convert": ["timestamp"],
        "data": []
      }
    },
    "non_empty": {
      "tsdf": {
        "ts_col": "timestamp",
        "series_ids": ["symbol"]
      },
      "df": {
        "schema": "timestamp string, symbol string, value double",
        "ts_convert": ["timestamp"],
        "data": [
          ["2021-01-01 10:00:00", "AAPL", 100.0],
          ["2021-01-01 10:05:00", "AAPL", 105.0]
        ]
      }
    },
    "expected_empty_right": {
      "tsdf": {
        "ts_col": "timestamp",
        "series_ids": ["symbol"]
      },
      "df": {
        "schema": "timestamp string, symbol string, value double, right_timestamp string, right_value double",
        "ts_convert": ["timestamp", "right_timestamp"],
        "data": [
          ["2021-01-01 10:00:00", "AAPL", 100.0, null, null],
          ["2021-01-01 10:05:00", "AAPL", 105.0, null, null]
        ]
      }
    }
  }
}