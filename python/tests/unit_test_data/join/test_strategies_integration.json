{
  "basic_join": {
    "left": {
      "tsdf": {
        "ts_col": "timestamp",
        "series_ids": ["symbol"]
      },
      "df": {
        "schema": "timestamp timestamp, symbol string, value double",
        "ts_convert": ["timestamp"],
        "data": [
          ["2021-01-01 10:00:00", "AAPL", 100.0],
          ["2021-01-01 10:05:00", "AAPL", 101.0],
          ["2021-01-01 10:10:00", "AAPL", 102.0],
          ["2021-01-01 10:00:00", "GOOGL", 200.0],
          ["2021-01-01 10:05:00", "GOOGL", 201.0],
          ["2021-01-01 10:10:00", "GOOGL", 202.0]
        ]
      }
    },
    "right": {
      "tsdf": {
        "ts_col": "timestamp",
        "series_ids": ["symbol"]
      },
      "df": {
        "schema": "timestamp timestamp, symbol string, price double",
        "ts_convert": ["timestamp"],
        "data": [
          ["2021-01-01 09:55:00", "AAPL", 99.5],
          ["2021-01-01 10:03:00", "AAPL", 100.5],
          ["2021-01-01 10:07:00", "AAPL", 101.5],
          ["2021-01-01 09:55:00", "GOOGL", 199.5],
          ["2021-01-01 10:03:00", "GOOGL", 200.5],
          ["2021-01-01 10:07:00", "GOOGL", 201.5]
        ]
      }
    },
    "expected_broadcast": {
      "tsdf": {
        "ts_col": "timestamp",
        "series_ids": ["symbol"]
      },
      "df": {
        "schema": "timestamp timestamp, symbol string, value double, right_timestamp timestamp, right_price double",
        "ts_convert": ["timestamp", "right_timestamp"],
        "data": [
          ["2021-01-01 10:00:00", "AAPL", 100.0, "2021-01-01 09:55:00", 99.5],
          ["2021-01-01 10:05:00", "AAPL", 101.0, "2021-01-01 10:03:00", 100.5],
          ["2021-01-01 10:10:00", "AAPL", 102.0, "2021-01-01 10:07:00", 101.5],
          ["2021-01-01 10:00:00", "GOOGL", 200.0, "2021-01-01 09:55:00", 199.5],
          ["2021-01-01 10:05:00", "GOOGL", 201.0, "2021-01-01 10:03:00", 200.5],
          ["2021-01-01 10:10:00", "GOOGL", 202.0, "2021-01-01 10:07:00", 201.5]
        ]
      }
    },
    "expected_union": {
      "tsdf": {
        "ts_col": "timestamp",
        "series_ids": ["symbol"]
      },
      "df": {
        "schema": "timestamp timestamp, symbol string, value double, right_timestamp timestamp, right_price double",
        "ts_convert": ["timestamp", "right_timestamp"],
        "data": [
          ["2021-01-01 10:00:00", "AAPL", 100.0, "2021-01-01 09:55:00", 99.5],
          ["2021-01-01 10:05:00", "AAPL", 101.0, "2021-01-01 10:03:00", 100.5],
          ["2021-01-01 10:10:00", "AAPL", 102.0, "2021-01-01 10:07:00", 101.5],
          ["2021-01-01 10:00:00", "GOOGL", 200.0, "2021-01-01 09:55:00", 199.5],
          ["2021-01-01 10:05:00", "GOOGL", 201.0, "2021-01-01 10:03:00", 200.5],
          ["2021-01-01 10:10:00", "GOOGL", 202.0, "2021-01-01 10:07:00", 201.5]
        ]
      }
    }
  },
  "tolerance_test": {
    "left": {
      "tsdf": {
        "ts_col": "timestamp",
        "series_ids": ["symbol"]
      },
      "df": {
        "schema": "timestamp timestamp, symbol string, value double",
        "ts_convert": ["timestamp"],
        "data": [
          ["2021-01-01 10:00:00", "AAPL", 100.0],
          ["2021-01-01 10:05:00", "AAPL", 101.0],
          ["2021-01-01 10:10:00", "AAPL", 102.0]
        ]
      }
    },
    "right": {
      "tsdf": {
        "ts_col": "timestamp",
        "series_ids": ["symbol"]
      },
      "df": {
        "schema": "timestamp timestamp, symbol string, price double",
        "ts_convert": ["timestamp"],
        "data": [
          ["2021-01-01 09:55:00", "AAPL", 99.5],
          ["2021-01-01 09:58:00", "AAPL", 99.8],
          ["2021-01-01 10:03:00", "AAPL", 100.5]
        ]
      }
    },
    "expected_tolerance_120": {
      "tsdf": {
        "ts_col": "timestamp",
        "series_ids": ["symbol"]
      },
      "df": {
        "schema": "timestamp timestamp, symbol string, value double, right_timestamp timestamp, right_price double",
        "ts_convert": ["timestamp", "right_timestamp"],
        "data": [
          ["2021-01-01 10:00:00", "AAPL", 100.0, "2021-01-01 09:58:00", 99.8],
          ["2021-01-01 10:05:00", "AAPL", 101.0, "2021-01-01 10:03:00", 100.5],
          ["2021-01-01 10:10:00", "AAPL", 102.0, null, null]
        ]
      }
    }
  },
  "null_handling": {
    "left": {
      "tsdf": {
        "ts_col": "timestamp",
        "series_ids": ["symbol"]
      },
      "df": {
        "schema": "timestamp timestamp, symbol string, value double",
        "ts_convert": ["timestamp"],
        "data": [
          ["2021-01-01 10:00:00", "AAPL", 100.0],
          ["2021-01-01 10:05:00", "AAPL", 101.0],
          ["2021-01-01 10:10:00", "AAPL", 102.0]
        ]
      }
    },
    "right": {
      "tsdf": {
        "ts_col": "timestamp",
        "series_ids": ["symbol"]
      },
      "df": {
        "schema": "timestamp timestamp, symbol string, price double",
        "ts_convert": ["timestamp"],
        "data": [
          ["2021-01-01 09:55:00", "AAPL", 99.5],
          ["2021-01-01 10:02:00", "AAPL", null],
          ["2021-01-01 10:07:00", "AAPL", 101.5]
        ]
      }
    },
    "expected_skip_nulls_true": {
      "tsdf": {
        "ts_col": "timestamp",
        "series_ids": ["symbol"]
      },
      "df": {
        "schema": "timestamp timestamp, symbol string, value double, right_timestamp timestamp, right_price double",
        "ts_convert": ["timestamp", "right_timestamp"],
        "data": [
          ["2021-01-01 10:00:00", "AAPL", 100.0, "2021-01-01 09:55:00", 99.5],
          ["2021-01-01 10:05:00", "AAPL", 101.0, "2021-01-01 09:55:00", 99.5],
          ["2021-01-01 10:10:00", "AAPL", 102.0, "2021-01-01 10:07:00", 101.5]
        ]
      }
    },
    "expected_skip_nulls_false": {
      "tsdf": {
        "ts_col": "timestamp",
        "series_ids": ["symbol"]
      },
      "df": {
        "schema": "timestamp timestamp, symbol string, value double, right_timestamp timestamp, right_price double",
        "ts_convert": ["timestamp", "right_timestamp"],
        "data": [
          ["2021-01-01 10:00:00", "AAPL", 100.0, "2021-01-01 09:55:00", 99.5],
          ["2021-01-01 10:05:00", "AAPL", 101.0, "2021-01-01 10:02:00", null],
          ["2021-01-01 10:10:00", "AAPL", 102.0, "2021-01-01 10:07:00", 101.5]
        ]
      }
    }
  },
  "empty_dataframes": {
    "left": {
      "tsdf": {
        "ts_col": "timestamp",
        "series_ids": ["symbol"]
      },
      "df": {
        "schema": "timestamp timestamp, symbol string, value double",
        "ts_convert": ["timestamp"],
        "data": []
      }
    },
    "right": {
      "tsdf": {
        "ts_col": "timestamp",
        "series_ids": ["symbol"]
      },
      "df": {
        "schema": "timestamp timestamp, symbol string, price double",
        "ts_convert": ["timestamp"],
        "data": [
          ["2021-01-01 10:00:00", "AAPL", 100.0]
        ]
      }
    },
    "expected": {
      "tsdf": {
        "ts_col": "timestamp",
        "series_ids": ["symbol"]
      },
      "df": {
        "schema": "timestamp timestamp, symbol string, value double, right_timestamp timestamp, right_price double",
        "ts_convert": ["timestamp", "right_timestamp"],
        "data": []
      }
    }
  },
  "null_lead_regression": {
    "left": {
      "tsdf": {
        "ts_col": "timestamp",
        "series_ids": ["symbol"]
      },
      "df": {
        "schema": "timestamp timestamp, symbol string, value double",
        "ts_convert": ["timestamp"],
        "data": [
          ["2021-01-01 10:00:00", "AAPL", 100.0],
          ["2021-01-01 10:05:00", "AAPL", 101.0],
          ["2021-01-01 10:10:00", "AAPL", 102.0]
        ]
      }
    },
    "right": {
      "tsdf": {
        "ts_col": "timestamp",
        "series_ids": ["symbol"]
      },
      "df": {
        "schema": "timestamp timestamp, symbol string, price double",
        "ts_convert": ["timestamp"],
        "data": [
          ["2021-01-01 09:55:00", "AAPL", 99.5],
          ["2021-01-01 10:15:00", "AAPL", 103.0]
        ]
      }
    },
    "expected": {
      "tsdf": {
        "ts_col": "timestamp",
        "series_ids": ["symbol"]
      },
      "df": {
        "schema": "timestamp timestamp, symbol string, value double, right_timestamp timestamp, right_price double",
        "ts_convert": ["timestamp", "right_timestamp"],
        "data": [
          ["2021-01-01 10:00:00", "AAPL", 100.0, "2021-01-01 09:55:00", 99.5],
          ["2021-01-01 10:05:00", "AAPL", 101.0, "2021-01-01 09:55:00", 99.5],
          ["2021-01-01 10:10:00", "AAPL", 102.0, "2021-01-01 09:55:00", 99.5]
        ]
      }
    }
  }
}